<?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource1">
      <DataSourceReference>/PDSS Reports/教學報表/DCMP/DCMP91</DataSourceReference>
      <rd:SecurityType>DataBase</rd:SecurityType>
      <rd:DataSourceID>90f5b1c5-9c93-42e5-b298-755d0dfc2fcb</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="機房動力統計">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@範圍">
            <Value>=Parameters!範圍.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@日期">
            <Value>=Parameters!日期.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@廠區">
            <Value>=Parameters!廠區.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@月份">
            <Value>=Parameters!月份.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@樓棟">
            <Value>=Parameters!樓棟.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@機房">
            <Value>=Parameters!機房.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@年份">
            <Value>=Parameters!年份.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>
if @範圍 = '月' 
select top 100 percent
 GPY_Time.CreateDate, SUM(GPY_Time.DiffValue) as 值 ,convert(char(10), GPY_Time.CreateDate, 120) as 日期, SUBSTRING((CONVERT(char(16),GPY_Time.CreateDate,120)),12,5) as 類別
  from 
(
	 select top 100 percent
	  Now.CreateDate, Now.SensorName
	  ,case
	  when Front.EveryPeriodMaxValue is null then Now.EveryPeriodMaxValue-NowMinValue.EveryPeriodMinValue
	  else Now.EveryPeriodMaxValue-Front.EveryPeriodMaxValue
	  end as DiffValue
	  
	 
	  
	  --, Now.EveryPeriodMaxValue-Front.EveryPeriodMaxValue as DiffValue 
	 from
	 (
		 select top 100 percent CONVERT(datetime,gpSensorMax.CreateDate) as CreateDate, MAX(gpSensorMax.Value) EveryPeriodMaxValue, gpSensorMax.SensorName from 
		(
			select top 100 percent CONVERT(char(13),CreateDate,120)+':00' CreateDate,CONVERT(float, A.Value) Value, C.Type,B.SensorName
			from 
			MonitData as A ,
			SensorInfo as B,
			AddressInfo as C,
			ControlInfo as D
			where -- DataID=68
			A.DataID = C.ID
			and C.SensorID = B.ID
			and C.ControlID = D.ID
			and C.Type ='有功電能'
			and B.Type = 'UPS電力'
			and (DATEPART(MM,CreateDate) = @月份) 
			and D.Factory = @廠區
			and D.Building = @樓棟
			and D.ComputerRoom = @機房
			and A.CreateDate &gt; CONVERT (nvarchar(4),@年份)+'-01-01' --修改時間:2017-7-17 16:21:51
			and ISNUMERIC(A.Value)&gt;0
		) as gpSensorMax
		group by gpSensorMax.CreateDate, gpSensorMax.SensorName
	 ) as Now
	 left join
	 (
		 select top 100 percent CONVERT(datetime,gpSensorMax.CreateDate) as CreateDate, MAX(gpSensorMax.Value) EveryPeriodMaxValue, gpSensorMax.SensorName from 
		(
			select top 100 percent CONVERT(char(13),CreateDate,120)+':00' CreateDate,CONVERT(float, A.Value) Value, C.Type,B.SensorName
			from 
			MonitData as A ,
			SensorInfo as B,
			AddressInfo as C,
			ControlInfo as D
			where -- DataID=68
			A.DataID = C.ID
			and C.SensorID = B.ID
			and C.ControlID = D.ID
			and C.Type ='有功電能'
			and B.Type = 'UPS電力'
			--and (DATEPART(MM,CreateDate) = @月份 ) 
			and D.Factory = @廠區
			and D.Building = @樓棟
			and D.ComputerRoom = @機房
			--and DATEPART(YYYY,A.CreateDate) = DATEPART(YYYY,GETDATE())
			and ISNUMERIC(A.Value)&gt;0
		) as gpSensorMax
		group by gpSensorMax.CreateDate, gpSensorMax.SensorName
	 ) as Front
	 on Front.CreateDate = DATEADD(HH,-1,Now.CreateDate)
	 and Now.SensorName = Front.SensorName

	left join
	(
		select top 100 percent CONVERT(datetime,gpSensorMin.CreateDate) as CreateDate, Min(gpSensorMin.Value) EveryPeriodMinValue, gpSensorMin.SensorName from 
		(
			select top 100 percent CONVERT(char(13),CreateDate,120)+':00' CreateDate,CONVERT(float, A.Value) Value, C.Type,B.SensorName
			from 
			MonitData as A ,
			SensorInfo as B,
			AddressInfo as C,
			ControlInfo as D
			where -- DataID=68
			A.DataID = C.ID
			and C.SensorID = B.ID
			and C.ControlID = D.ID
			and C.Type ='有功電能'
			and B.Type = 'UPS電力'
			and (DATEPART(MM,CreateDate) = @月份) 
			and D.Factory = @廠區
			and D.Building = @樓棟
			and D.ComputerRoom = @機房
			and A.CreateDate &gt; CONVERT (nvarchar(4),@年份)+'-01-01' --修改時間:2017-7-17 16:21:51
			and ISNUMERIC(A.Value)&gt;0
		) as gpSensorMin
		group by gpSensorMin.CreateDate, gpSensorMin.SensorName
		order by CreateDate
	)as NowMinValue
	on NowMinValue.CreateDate = Now.CreateDate
	and  NowMinValue.SensorName = Now.SensorName
	 
	 order by Now.CreateDate
) as GPY_Time
group by GPY_Time.CreateDate

else
--------------------------------------------------------------------------------------------------按@日期查找
 ------------------------------------------------------ 各時段與前一時段的差值,按日期查找
select top 100 percent
 GPY_Time.CreateDate, SUM(GPY_Time.DiffValue) as 值 ,convert(char(10), GPY_Time.CreateDate, 120) as 日期, SUBSTRING((CONVERT(char(16),GPY_Time.CreateDate,120)),12,5) as 類別
  from 
(
	 select top 100 percent
	  Now.CreateDate, Now.SensorName
	  ,case
	  when Front.EveryPeriodMaxValue is null then Now.EveryPeriodMaxValue-NowMinValue.EveryPeriodMinValue
	  else Now.EveryPeriodMaxValue-Front.EveryPeriodMaxValue
	  end as DiffValue
	  
	 
	  
	  --, Now.EveryPeriodMaxValue-Front.EveryPeriodMaxValue as DiffValue 
	 from
	 (
		 select top 100 percent CONVERT(datetime,gpSensorMax.CreateDate) as CreateDate, MAX(gpSensorMax.Value) EveryPeriodMaxValue, gpSensorMax.SensorName from 
		(
			select top 100 percent CONVERT(char(13),CreateDate,120)+':00' CreateDate,CONVERT(float, A.Value) Value, C.Type,B.SensorName
			from 
			MonitData as A ,
			SensorInfo as B,
			AddressInfo as C,
			ControlInfo as D
			where -- DataID=68
			A.DataID = C.ID
			and C.SensorID = B.ID
			and C.ControlID = D.ID
			and C.Type ='有功電能'
			and B.Type = 'UPS電力'
			and CONVERT(char(10),A.CreateDate, 120) = @日期
			and CONVERT(char(10),A.CreateDate, 120) = @日期
			and D.Factory = @廠區
			and D.Building = @樓棟
			and D.ComputerRoom = @機房
			and A.CreateDate &gt; CONVERT (nvarchar(4),@年份)+'-01-01' --修改時間:2017-7-17 16:21:51
			and ISNUMERIC(A.Value)&gt;0
		) as gpSensorMax
		group by gpSensorMax.CreateDate, gpSensorMax.SensorName
	 ) as Now
	 left join
	 (
		 select top 100 percent CONVERT(datetime,gpSensorMax.CreateDate) as CreateDate, MAX(gpSensorMax.Value) EveryPeriodMaxValue, gpSensorMax.SensorName from 
		(
			select top 100 percent CONVERT(char(13),CreateDate,120)+':00' CreateDate,CONVERT(float, A.Value) Value, C.Type,B.SensorName
			from 
			MonitData as A ,
			SensorInfo as B,
			AddressInfo as C,
			ControlInfo as D
			where -- DataID=68
			A.DataID = C.ID
			and C.SensorID = B.ID
			and C.ControlID = D.ID
			and C.Type ='有功電能'
			and B.Type = 'UPS電力'
			--and (DATEPART(MM,CreateDate) = @月份 ) 
			and D.Factory = @廠區
			and D.Building = @樓棟
			and D.ComputerRoom = @機房
			--and DATEPART(YYYY,A.CreateDate) = DATEPART(YYYY,GETDATE())
			and ISNUMERIC(A.Value)&gt;0
		) as gpSensorMax
		group by gpSensorMax.CreateDate, gpSensorMax.SensorName
	 ) as Front
	 on Front.CreateDate = DATEADD(HH,-1,Now.CreateDate)
	 and Now.SensorName = Front.SensorName

	left join
	(
		select top 100 percent CONVERT(datetime,gpSensorMin.CreateDate) as CreateDate, Min(gpSensorMin.Value) EveryPeriodMinValue, gpSensorMin.SensorName from 
		(
			select top 100 percent CONVERT(char(13),CreateDate,120)+':00' CreateDate,CONVERT(float, A.Value) Value, C.Type,B.SensorName
			from 
			MonitData as A ,
			SensorInfo as B,
			AddressInfo as C,
			ControlInfo as D
			where -- DataID=68
			A.DataID = C.ID
			and C.SensorID = B.ID
			and C.ControlID = D.ID
			and C.Type ='有功電能'
			and B.Type = 'UPS電力'
			and CONVERT(char(10),A.CreateDate, 120) = @日期
			and D.Factory = @廠區
			and D.Building = @樓棟
			and D.ComputerRoom = @機房
			and A.CreateDate &gt; CONVERT (nvarchar(4),@年份)+'-01-01' --修改時間:2017-7-17 16:21:51
			and ISNUMERIC(A.Value)&gt;0
		) as gpSensorMin
		group by gpSensorMin.CreateDate, gpSensorMin.SensorName
		order by CreateDate
	)as NowMinValue
	on NowMinValue.CreateDate = Now.CreateDate
	and  NowMinValue.SensorName = Now.SensorName
	 
	 order by Now.CreateDate
) as GPY_Time
group by GPY_Time.CreateDate</CommandText>
      </Query>
      <Fields>
        <Field Name="日期">
          <DataField>日期</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="CreateDate">
          <DataField>CreateDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="類別">
          <DataField>類別</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="值">
          <DataField>值</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="工廠下拉">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>select distinct Plant from PlantInfo</CommandText>
      </Query>
      <Fields>
        <Field Name="Plant">
          <DataField>Plant</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="樓棟">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@廠區">
            <Value>=Parameters!廠區.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>select distinct Building from PlantInfo
where Plant = @廠區</CommandText>
      </Query>
      <Fields>
        <Field Name="Building">
          <DataField>Building</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="機房">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@廠區">
            <Value>=Parameters!廠區.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@樓棟">
            <Value>=Parameters!樓棟.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>select distinct ComputerRoom from PlantInfo
where Plant = @廠區
and Building = @樓棟</CommandText>
      </Query>
      <Fields>
        <Field Name="ComputerRoom">
          <DataField>ComputerRoom</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="指定範圍月">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>select '月' as 範圍</CommandText>
      </Query>
      <Fields>
        <Field Name="範圍">
          <DataField>範圍</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="默認月份">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>select datepart(MM,getdate()) as Month</CommandText>
      </Query>
      <Fields>
        <Field Name="Month">
          <DataField>Month</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DateNow">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>select convert(char(10),getdate(),120) as Date,getdate() as Time
</CommandText>
      </Query>
      <Fields>
        <Field Name="Date">
          <DataField>Date</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Time">
          <DataField>Time</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="單個設備">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@SensorName">
            <Value>=Parameters!SensorName.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@廠區">
            <Value>=Parameters!廠區.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@樓棟">
            <Value>=Parameters!樓棟.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@機房">
            <Value>=Parameters!機房.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>
declare @tb table
(
--index int identity(1,1)
id int identity(1,1)
,Value float
,CreateDate datetime
,Type nvarchar(40)
,SensorName nvarchar(40)
)

insert @tb (Value,CreateDate,Type,SensorName)
select CONVERT(float,A.Value),A.CreateDate, C.Type,B.SensorName			from 
			MonitData as A ,
			SensorInfo as B,
			AddressInfo as C,
			ControlInfo as D
			where 
			A.DataID = C.ID
			and C.SensorID = B.ID
			and C.ControlID = D.ID
			and D.Factory = @廠區
			and D.Building = @樓棟
			and D.ComputerRoom = @機房
			and C.Type like'%有功電能'
			and B.Type = 'UPS電力'
			and B.SensorName = @SensorName
			and A.CreateDate&gt;CONVERT(datetime,CONVERT(char(10),GETDATE(),120))
			--and CONVERT(char(10),A.CreateDate,120) = CONVERT(char(10),GETDATE(),120)
			order by SensorName,C.Type,CreateDate
			
			
			select 
			--A.*,
			CONVERT(float,B.Value) - CONVERT(float,A.Value)  as DiffValue
			,A.CreateDate
			,SUBSTRING(CONVERT(char(16),A.CreateDate,120),12,16) as Time
			,datediff(SECOND,A.CreateDate,B.CreateDate) as TimeSpace
			,datediff(SECOND,A.CreateDate,B.CreateDate)/600.0 as Rate
			,(CONVERT(float,B.Value) - CONVERT(float,A.Value)) / (datediff(SECOND,A.CreateDate,B.CreateDate)/3600.0) as RectifyValue
			--,(CONVERT(float,B.Value) - CONVERT(float,A.Value))/(datediff(MINUTE,A.CreateDate,B.CreateDate)/10.0) as RectifyValue
			,CONVERT(char(4),SUBSTRING(CONVERT(char(16),A.CreateDate,120),12,16)) + '0' as RectifyTime
			
			from @tb as A,@tb as B
			where A.id = B.id-1
			and A.Type = B.Type
			and A.SensorName = B.SensorName
			and A.CreateDate != B.CreateDate
			
			--order by A.id</CommandText>
      </Query>
      <Fields>
        <Field Name="DiffValue">
          <DataField>DiffValue</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="CreateDate">
          <DataField>CreateDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="Time">
          <DataField>Time</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TimeSpace">
          <DataField>TimeSpace</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Rate">
          <DataField>Rate</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="RectifyTime">
          <DataField>RectifyTime</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="RectifyValue">
          <DataField>RectifyValue</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="ListSensorName">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>select SensorName from SensorInfo
where SensorName like '%UPS%相'</CommandText>
      </Query>
      <Fields>
        <Field Name="SensorName">
          <DataField>SensorName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixCorner>
              <TablixCornerRows>
                <TablixCornerRow>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox17">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>時間</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox17</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#7292cc</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#4c68a2</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                      <RowSpan>2</RowSpan>
                    </CellContents>
                  </TablixCornerCell>
                </TablixCornerRow>
                <TablixCornerRow>
                  <TablixCornerCell />
                </TablixCornerRow>
              </TablixCornerRows>
            </TablixCorner>
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>18.38541mm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>6mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="值">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=IIf((Sum(Fields!值.Value))=0,0,Sum(Fields!值.Value))</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>f2</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>值</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember>
                  <TablixHeader>
                    <Size>6mm</Size>
                    <CellContents>
                      <Textbox Name="Textbox18">
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>機房各時段動力統計</Value>
                                <Style>
                                  <FontStyle>Normal</FontStyle>
                                  <FontFamily>微軟正黑體</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <TextDecoration>None</TextDecoration>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox18</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#c6daf8</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#9eb6e4</BackgroundColor>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <TablixMember>
                      <Group Name="類別">
                        <GroupExpressions>
                          <GroupExpression>=Fields!類別.Value</GroupExpression>
                        </GroupExpressions>
                      </Group>
                      <SortExpressions>
                        <SortExpression>
                          <Value>=Fields!類別.Value</Value>
                        </SortExpression>
                      </SortExpressions>
                      <TablixHeader>
                        <Size>6mm</Size>
                        <CellContents>
                          <Textbox Name="類別">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>=Fields!類別.Value</Value>
                                    <Style>
                                      <FontFamily>Tahoma</FontFamily>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>#465678</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style>
                                  <TextAlign>Center</TextAlign>
                                </Style>
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>類別</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>#c6daf8</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>#9eb6e4</BackgroundColor>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                      <TablixMembers>
                        <TablixMember />
                      </TablixMembers>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="日期">
                    <GroupExpressions>
                      <GroupExpression>=Fields!日期.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!日期.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <TablixHeader>
                    <Size>24.47083mm</Size>
                    <CellContents>
                      <Textbox Name="日期">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>=Fields!日期.Value</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>#465678</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>日期</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#c6daf8</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#9eb6e4</BackgroundColor>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <TablixMember />
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>機房動力統計</DataSetName>
            <Top>83.185mm</Top>
            <Left>0mm</Left>
            <Height>18mm</Height>
            <Width>42.85624mm</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
          <Textbox Name="Textbox7">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>單位：kWh</Value>
                    <Style />
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <rd:DefaultName>Textbox7</rd:DefaultName>
            <Top>75.27396mm</Top>
            <Left>0mm</Left>
            <Height>6.08542mm</Height>
            <Width>21.43125mm</Width>
            <ZIndex>1</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Chart Name="Chart2">
            <ChartCategoryHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Group Name="Chart2_CategoryGroup">
                    <GroupExpressions>
                      <GroupExpression>=Fields!Time.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!Time.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <Label>=Fields!Time.Value</Label>
                </ChartMember>
              </ChartMembers>
            </ChartCategoryHierarchy>
            <ChartSeriesHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Label>Rectify Value</Label>
                </ChartMember>
              </ChartMembers>
            </ChartSeriesHierarchy>
            <ChartData>
              <ChartSeriesCollection>
                <ChartSeries Name="RectifyValue">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <X>=Fields!RectifyTime.Value</X>
                        <Y>=Sum(Fields!RectifyValue.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style />
                      </ChartDataLabel>
                      <ToolTip>=Round(Sum(Fields!RectifyValue.Value),2)</ToolTip>
                      <Style>
                        <BackgroundGradientType>None</BackgroundGradientType>
                        <BackgroundGradientEndColor>Yellow</BackgroundGradientEndColor>
                        <BackgroundHatchType>None</BackgroundHatchType>
                      </Style>
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Area</Type>
                  <Style>
                    <ShadowOffset>0pt</ShadowOffset>
                  </Style>
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
              </ChartSeriesCollection>
            </ChartData>
            <ChartAreas>
              <ChartArea Name="Default">
                <ChartCategoryAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>時間</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <Interval>20</Interval>
                    <IntervalType>Default</IntervalType>
                    <ChartMajorGridLines>
                      <Enabled>True</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Enabled>True</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Enabled>True</Enabled>
                      <Length>0.5</Length>
                      <Interval>1</Interval>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <Angle>-90</Angle>
                    <LabelsAutoFitDisabled>true</LabelsAutoFitDisabled>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartCategoryAxes>
                <ChartValueAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>電能值kW·h/h</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartValueAxes>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <BackgroundHatchType>BackwardDiagonal</BackgroundHatchType>
                </Style>
              </ChartArea>
            </ChartAreas>
            <ChartLegends>
              <ChartLegend Name="Default">
                <Hidden>true</Hidden>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartLegendTitle>
                  <Caption />
                  <Style>
                    <FontSize>8pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </ChartLegendTitle>
                <HeaderSeparatorColor>Black</HeaderSeparatorColor>
                <ColumnSeparatorColor>Black</ColumnSeparatorColor>
              </ChartLegend>
            </ChartLegends>
            <ChartTitles>
              <ChartTitle Name="Default">
                <Caption>=Parameters!SensorName.Value+"本日用電量"</Caption>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontWeight>Bold</FontWeight>
                  <TextAlign>General</TextAlign>
                  <VerticalAlign>Top</VerticalAlign>
                </Style>
              </ChartTitle>
            </ChartTitles>
            <Palette>BrightPastel</Palette>
            <ChartBorderSkin>
              <Style>
                <BackgroundColor>Gray</BackgroundColor>
                <BackgroundGradientType>None</BackgroundGradientType>
                <Color>White</Color>
              </Style>
            </ChartBorderSkin>
            <ChartNoDataMessage Name="NoDataMessage">
              <Caption>沒有可用資料</Caption>
              <Style>
                <BackgroundGradientType>None</BackgroundGradientType>
                <TextAlign>General</TextAlign>
                <VerticalAlign>Top</VerticalAlign>
              </Style>
            </ChartNoDataMessage>
            <DataSetName>單個設備</DataSetName>
            <Top>0mm</Top>
            <Left>0mm</Left>
            <Height>65.875mm</Height>
            <Width>310.69742mm</Width>
            <ZIndex>2</ZIndex>
            <Style>
              <Border>
                <Color>LightGrey</Color>
                <Style>Solid</Style>
              </Border>
              <BackgroundColor>White</BackgroundColor>
              <BackgroundGradientType>None</BackgroundGradientType>
            </Style>
          </Chart>
          <Textbox Name="Textbox3">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>說明：縱軸表示單位小時內電能值, 面積表示該段時間電能值</Value>
                    <Style />
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <rd:DefaultName>Textbox3</rd:DefaultName>
            <Top>67.17242mm</Top>
            <Left>0.762mm</Left>
            <Height>5.01474mm</Height>
            <Width>98.68958mm</Width>
            <ZIndex>3</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
        </ReportItems>
        <Height>101.97875mm</Height>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Body>
      <Width>319.97242mm</Width>
      <Page>
        <PageFooter>
          <Height>11.43mm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="Textbox1">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=First(Fields!Time.Value, "DateNow")</Value>
                      <Style />
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Left</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>Textbox1</rd:DefaultName>
              <Top>2.25499mm</Top>
              <Left>0mm</Left>
              <Height>6mm</Height>
              <Width>67.06875mm</Width>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageFooter>
        <PageHeight>297mm</PageHeight>
        <PageWidth>210mm</PageWidth>
        <LeftMargin>20mm</LeftMargin>
        <RightMargin>20mm</RightMargin>
        <TopMargin>20mm</TopMargin>
        <BottomMargin>20mm</BottomMargin>
        <ColumnSpacing>0.13cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="廠區">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>工廠下拉</DataSetName>
          <ValueField>Plant</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>廠區</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>工廠下拉</DataSetName>
          <ValueField>Plant</ValueField>
          <LabelField>Plant</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="樓棟">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>樓棟</DataSetName>
          <ValueField>Building</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>樓棟</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>樓棟</DataSetName>
          <ValueField>Building</ValueField>
          <LabelField>Building</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="機房">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>機房</DataSetName>
          <ValueField>ComputerRoom</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>機房</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>機房</DataSetName>
          <ValueField>ComputerRoom</ValueField>
          <LabelField>ComputerRoom</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="範圍">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>指定範圍月</DataSetName>
          <ValueField>範圍</ValueField>
        </DataSetReference>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
      <Prompt>範圍</Prompt>
      <Hidden>true</Hidden>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>月</Value>
            <Label>月</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>日</Value>
            <Label>日</Label>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="月份">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>默認月份</DataSetName>
          <ValueField>Month</ValueField>
        </DataSetReference>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
      <Prompt>月份</Prompt>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>1</Value>
            <Label>1月</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>2</Value>
            <Label>2月</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>3</Value>
            <Label>3月</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>4</Value>
            <Label>4月</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>5</Value>
            <Label>5月</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>6</Value>
            <Label>6月</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>7</Value>
            <Label>7月</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>8</Value>
            <Label>8月</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>9</Value>
            <Label>9月</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>10</Value>
            <Label>10月</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>11</Value>
            <Label>11月</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>12</Value>
            <Label>12月</Label>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="日期">
      <DataType>DateTime</DataType>
      <Nullable>true</Nullable>
      <DefaultValue>
        <Values>
          <Value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" />
        </Values>
      </DefaultValue>
      <Prompt>日期</Prompt>
      <Hidden>true</Hidden>
    </ReportParameter>
    <ReportParameter Name="SensorName">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>ListSensorName</DataSetName>
          <ValueField>SensorName</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>設備名稱</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>ListSensorName</DataSetName>
          <ValueField>SensorName</ValueField>
          <LabelField>SensorName</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="年份">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>=Year(Globals!ExecutionTime)</Value>
        </Values>
      </DefaultValue>
      <Prompt>年份</Prompt>
    </ReportParameter>
  </ReportParameters>
  <rd:ReportUnitType>Mm</rd:ReportUnitType>
  <rd:ReportServerUrl>http://10.62.197.16/ReportServer</rd:ReportServerUrl>
  <rd:ReportID>f641c6b1-9f7c-44c6-aa85-4c2dba3cedb8</rd:ReportID>
</Report>