<?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource1">
      <DataSourceReference>/ABD/SFC/AbdCelerSFC</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>53e16aea-cfb6-469c-be6a-693641930f54</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet1">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@CustNo">
            <Value>=Parameters!CustNo.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@Level">
            <Value>=Parameters!Level.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@StartDate">
            <Value>=Parameters!StartDate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@EndDate">
            <Value>=Parameters!EndDate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@StartTime">
            <Value>=Parameters!StartTime.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@EndTime">
            <Value>=Parameters!EndTime.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@ModelName">
            <Value>=Parameters!ModelName.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@Line_Name">
            <Value>=Parameters!Line_Name.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@WO">
            <Value>=Parameters!WO.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@ModelClass">
            <Value>=Parameters!ModelClass.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@Type2">
            <Value>=Parameters!Type2.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>execute proc_YieldRate 
 @CustNo 
,@Level 
,@StartDate 
,@EndDate 
,@StartTime 
,@EndTime 
,@ModelName 
,@Line_Name 
,@WO 
,@ModelClass 
,@Type2</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="WorkDate">
          <DataField>WorkDate</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ModelClass">
          <DataField>ModelClass</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Weeks">
          <DataField>Weeks</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="DefaultLine">
          <DataField>DefaultLine</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ModelName">
          <DataField>ModelName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="GroupName">
          <DataField>GroupName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="PassQty">
          <DataField>PassQty</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="FPYSeq">
          <DataField>FPYSeq</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="FailQty">
          <DataField>FailQty</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="YieldRate">
          <DataField>YieldRate</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="FPYGoal">
          <DataField>FPYGoal</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="MoNumber">
          <DataField>MoNumber</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DateType">
          <DataField>DateType</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="groupForYieldRate">
          <DataField>groupForYieldRate</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="yieldRateForChart">
          <DataField>yieldRateForChart</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="groupForVerticalYieldRate">
          <DataField>groupForVerticalYieldRate</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="yieldRateForVertical">
          <DataField>yieldRateForVertical</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="時間">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText> 
 declare @time table(
 times nvarchar(5)

 )
 declare @i int
 set @i = 0
 while (@i&lt;25)
 begin
 insert @time values(@i)
 set @i +=1
 end
 select * from @time
 union 
 select ' '</CommandText>
      </Query>
      <Fields>
        <Field Name="times">
          <DataField>times</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="ListModelName">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>SELECT distinct
A.ModelName
--,D.ModelClass
--,B.LevelGrade, A.WorkDate,D.ModelClass,B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate) AS Weeks,A.GroupName, D.FPYSeq, D.FPYGoal ,Sum(A.PassQty) as PassQty,
--           Sum(A.FailQty) as FailQty
--           --, (Sum(A.PassQty) + Sum(A.FailQty)) as TotalQty
--           ,case (Sum(A.PassQty) + Sum(A.FailQty)) when 0 then 1 else sum(PassQty) / (Sum(A.PassQty) + Sum(A.FailQty))  end as YieldRate
           --,Sum(A.RepassQty) RepassQty, Sum(A.RefailQty) RefailQty
  FROM R_STATION_REC_T A
  left join  R_MO_BASE_T B on A.MoNumber  = B.MoNumber
  left join  C_GROUP_CONFIG_T C on A.GroupName = C.GroupName
  join (select CM.ModelName, CM.Rev AS VersionCode ,FM.ID, FM.LevelGrade, FM.ModelClass, FM.FPYGoal, FD.FPYSeq, FD.GroupName, FD.StandardYield 
          from FpySettingM FM 
          join FpySettingD FD on FM.ID = FD.MID
          join C_MODEL_DESC_T CM on FM.ModelClass = CM.ModelClass) D on B.ModelName = D.ModelName and C.GroupName = D.GroupName
 --WHERE  
 
 --D.ModelClass = @ModelClass or @ModelClass = 'ALL'
 --B.CustNo  =@CustNo  --客戶
 --  AND B.LevelGrade =@Level   --製程等級
   --and WorkDate&gt;=CONVERT(nvarchar,@StartDate,112) and  WorkDate &lt;=CONVERT(nvarchar,@EndDate,112)  --生產日期起迄
   --and CAST(WorkSection as int)&gt;=cast(left(@StartTime,2)as int) and CAST(WorkSection as int)&lt;=cast(left(@EndTime,2)as int)  --時間段起迄
   --AND (A.ModelName in (@Product) or @Product is null or @Product = '' or 1=1) --機種
   --AND (@Line_Name='All' or A.LineName LIKE '%'+@Line_Name+'%' ) --線別
   --AND (@WO='All' or A.MoNumber LIKE '%'+@WO+'%')  --工單號碼
   --AND D.ModelClass like '%'+@ModelClass+'%' --產品類型
 --GROUP BY D.ModelClass,B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate),A.WorkDate,A.GroupName,D.FPYSeq,D.FPYGoal
 --ORDER BY B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate),D.FPYSeq
union 
 select 'ALL'</CommandText>
      </Query>
      <Fields>
        <Field Name="ModelName">
          <DataField>ModelName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="ListModelClass1">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>SELECT distinct
--A.ModelName
D.ModelClass
--B.CustNo
--A.MoNumber
--LineName
--B.LevelGrade
  FROM R_STATION_REC_T A
  left join  R_MO_BASE_T B on A.MoNumber  = B.MoNumber
  left join  C_GROUP_CONFIG_T C on A.GroupName = C.GroupName
  join (select CM.ModelName, CM.Rev AS VersionCode ,FM.ID, FM.LevelGrade, FM.ModelClass, FM.FPYGoal, FD.FPYSeq, FD.GroupName, FD.StandardYield 
          from FpySettingM FM 
          join FpySettingD FD on FM.ID = FD.MID
          join C_MODEL_DESC_T CM on FM.ModelClass = CM.ModelClass) D on B.ModelName = D.ModelName and C.GroupName = D.GroupName
 --WHERE  
 
 --D.ModelClass = @ModelClass or @ModelClass = 'ALL'
 --B.CustNo  =@CustNo  --客戶
 --  AND B.LevelGrade =@Level   --製程等級
   --and WorkDate&gt;=CONVERT(nvarchar,@StartDate,112) and  WorkDate &lt;=CONVERT(nvarchar,@EndDate,112)  --生產日期起迄
   --and CAST(WorkSection as int)&gt;=cast(left(@StartTime,2)as int) and CAST(WorkSection as int)&lt;=cast(left(@EndTime,2)as int)  --時間段起迄
   --AND (A.ModelName in (@ModelName) or @ModelName ='ALL' ) --機種
   --AND (@Line_Name='All' or A.LineName LIKE '%'+@Line_Name+'%' ) --線別
   --AND (@WO='All' or A.MoNumber LIKE '%'+@WO+'%')  --工單號碼
   --AND D.ModelClass like '%'+@ModelClass+'%' --產品類型
 --GROUP BY D.ModelClass,B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate),A.WorkDate,A.GroupName,D.FPYSeq,D.FPYGoal
 --ORDER BY B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate),D.FPYSeq
</CommandText>
      </Query>
      <Fields>
        <Field Name="ModelClass">
          <DataField>ModelClass</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="ListCustNo">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>/****** SSMS 中 SelectTopNRows 命令的指令碼  ******/
SELECT TOP 1000 [Customer]

      ,[CustNo]

  FROM [Ame_PDSS_ABDCelerSFC].[dbo].[C_CUSTOMER_T]
union select  'ALL','ALL'</CommandText>
      </Query>
      <Fields>
        <Field Name="CustNo">
          <DataField>CustNo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Customer">
          <DataField>Customer</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="ListWO">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>SELECT distinct
--A.ModelName
--D.ModelClass
--B.CustNo
A.MoNumber
  FROM R_STATION_REC_T A
  left join  R_MO_BASE_T B on A.MoNumber  = B.MoNumber
  left join  C_GROUP_CONFIG_T C on A.GroupName = C.GroupName
  join (select CM.ModelName, CM.Rev AS VersionCode ,FM.ID, FM.LevelGrade, FM.ModelClass, FM.FPYGoal, FD.FPYSeq, FD.GroupName, FD.StandardYield 
          from FpySettingM FM 
          join FpySettingD FD on FM.ID = FD.MID
          join C_MODEL_DESC_T CM on FM.ModelClass = CM.ModelClass) D on B.ModelName = D.ModelName and C.GroupName = D.GroupName
 --WHERE  
 
 --D.ModelClass = @ModelClass or @ModelClass = 'ALL'
 --B.CustNo  =@CustNo  --客戶
 --  AND B.LevelGrade =@Level   --製程等級
   --and WorkDate&gt;=CONVERT(nvarchar,@StartDate,112) and  WorkDate &lt;=CONVERT(nvarchar,@EndDate,112)  --生產日期起迄
   --and CAST(WorkSection as int)&gt;=cast(left(@StartTime,2)as int) and CAST(WorkSection as int)&lt;=cast(left(@EndTime,2)as int)  --時間段起迄
   --AND (A.ModelName in (@ModelName) or @ModelName ='ALL' ) --機種
   --AND (@Line_Name='All' or A.LineName LIKE '%'+@Line_Name+'%' ) --線別
   --AND (@WO='All' or A.MoNumber LIKE '%'+@WO+'%')  --工單號碼
   --AND D.ModelClass like '%'+@ModelClass+'%' --產品類型
 --GROUP BY D.ModelClass,B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate),A.WorkDate,A.GroupName,D.FPYSeq,D.FPYGoal
 --ORDER BY B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate),D.FPYSeq
union 
 select 'ALL'</CommandText>
      </Query>
      <Fields>
        <Field Name="MoNumber">
          <DataField>MoNumber</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="ListLineName">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>SELECT distinct
--A.ModelName
--D.ModelClass
--B.CustNo
--A.MoNumber
LineName
  FROM R_STATION_REC_T A
  left join  R_MO_BASE_T B on A.MoNumber  = B.MoNumber
  left join  C_GROUP_CONFIG_T C on A.GroupName = C.GroupName
  join (select CM.ModelName, CM.Rev AS VersionCode ,FM.ID, FM.LevelGrade, FM.ModelClass, FM.FPYGoal, FD.FPYSeq, FD.GroupName, FD.StandardYield 
          from FpySettingM FM 
          join FpySettingD FD on FM.ID = FD.MID
          join C_MODEL_DESC_T CM on FM.ModelClass = CM.ModelClass) D on B.ModelName = D.ModelName and C.GroupName = D.GroupName
 --WHERE  
 
 --D.ModelClass = @ModelClass or @ModelClass = 'ALL'
 --B.CustNo  =@CustNo  --客戶
 --  AND B.LevelGrade =@Level   --製程等級
   --and WorkDate&gt;=CONVERT(nvarchar,@StartDate,112) and  WorkDate &lt;=CONVERT(nvarchar,@EndDate,112)  --生產日期起迄
   --and CAST(WorkSection as int)&gt;=cast(left(@StartTime,2)as int) and CAST(WorkSection as int)&lt;=cast(left(@EndTime,2)as int)  --時間段起迄
   --AND (A.ModelName in (@ModelName) or @ModelName ='ALL' ) --機種
   --AND (@Line_Name='All' or A.LineName LIKE '%'+@Line_Name+'%' ) --線別
   --AND (@WO='All' or A.MoNumber LIKE '%'+@WO+'%')  --工單號碼
   --AND D.ModelClass like '%'+@ModelClass+'%' --產品類型
 --GROUP BY D.ModelClass,B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate),A.WorkDate,A.GroupName,D.FPYSeq,D.FPYGoal
 --ORDER BY B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate),D.FPYSeq
union 
 select 'ALL'
</CommandText>
      </Query>
      <Fields>
        <Field Name="LineName">
          <DataField>LineName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="listLevel">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>SELECT distinct
--A.ModelName
--D.ModelClass
--B.CustNo
--A.MoNumber
--LineName
B.LevelGrade
  FROM R_STATION_REC_T A
  left join  R_MO_BASE_T B on A.MoNumber  = B.MoNumber
  left join  C_GROUP_CONFIG_T C on A.GroupName = C.GroupName
  join (select CM.ModelName, CM.Rev AS VersionCode ,FM.ID, FM.LevelGrade, FM.ModelClass, FM.FPYGoal, FD.FPYSeq, FD.GroupName, FD.StandardYield 
          from FpySettingM FM 
          join FpySettingD FD on FM.ID = FD.MID
          join C_MODEL_DESC_T CM on FM.ModelClass = CM.ModelClass) D on B.ModelName = D.ModelName and C.GroupName = D.GroupName
 --WHERE  
 
 --D.ModelClass = @ModelClass or @ModelClass = 'ALL'
 --B.CustNo  =@CustNo  --客戶
 --  AND B.LevelGrade =@Level   --製程等級
   --and WorkDate&gt;=CONVERT(nvarchar,@StartDate,112) and  WorkDate &lt;=CONVERT(nvarchar,@EndDate,112)  --生產日期起迄
   --and CAST(WorkSection as int)&gt;=cast(left(@StartTime,2)as int) and CAST(WorkSection as int)&lt;=cast(left(@EndTime,2)as int)  --時間段起迄
   --AND (A.ModelName in (@ModelName) or @ModelName ='ALL' ) --機種
   --AND (@Line_Name='All' or A.LineName LIKE '%'+@Line_Name+'%' ) --線別
   --AND (@WO='All' or A.MoNumber LIKE '%'+@WO+'%')  --工單號碼
   --AND D.ModelClass like '%'+@ModelClass+'%' --產品類型
 --GROUP BY D.ModelClass,B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate),A.WorkDate,A.GroupName,D.FPYSeq,D.FPYGoal
 --ORDER BY B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate),D.FPYSeq
union 
 select 'ALL'</CommandText>
      </Query>
      <Fields>
        <Field Name="LevelGrade">
          <DataField>LevelGrade</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="chartGroupbyDay">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@CustNo">
            <Value>=Parameters!CustNo.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@Level">
            <Value>=Parameters!Level.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@StartDate">
            <Value>=Parameters!StartDate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@EndDate">
            <Value>=Parameters!EndDate.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@StartTime">
            <Value>=Parameters!StartTime.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@EndTime">
            <Value>=Parameters!EndTime.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@ModelName">
            <Value>=Parameters!ModelName.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@Line_Name">
            <Value>=Parameters!Line_Name.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@WO">
            <Value>=Parameters!WO.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@ModelClass">
            <Value>=Parameters!ModelClass.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@Type2">
            <Value>=Parameters!Type2.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>
declare @TB1 table(
WorkDate nvarchar(20)
,ModelClass nvarchar(20)
,ModelName nvarchar(50)
,DefaultLine nvarchar(20)
,Weeks int
,GroupName nvarchar(50)
,FPYSeq int
,FPYGoal float
,PassQty int
,FailQty int
,YieldRate float
)

declare @TB2 table(
WorkDate nvarchar(20)
,ModelClass nvarchar(20)
,ModelName nvarchar(50)
,DefaultLine nvarchar(20)
,Weeks int
,GroupName nvarchar(50)
,FPYSeq int
,FPYGoal float
,PassQty int
,FailQty int
,YieldRate float
,FVI1 float
,FVI1_passQty int
,FVI1FailQty int
,PRE_TEST float
,PRE_TESTPassQty int
,PRE_TESTFailQty int
,[RUNIN] float
,RUNIN_Pass int
,RunIN_Fail int
,Fvi2 float
,Fvi2_Pass int
,Fvi2_Fail int
,Si float
,Si_pass int
,SI_Fail int

)

--declare @WO nvarchar(50),@CustNo nvarchar(30),@Level nvarchar(40),@StartDate datetime,@EndDate datetime
--,@StartTime datetime, @EndTime datetime, @ModelName nvarchar(50),@Line_Name nvarchar(50),@ModelClass nvarchar(50)


insert @TB1
SELECT A.WorkDate,D.ModelClass,B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate) AS Weeks,A.GroupName, D.FPYSeq, D.FPYGoal ,Sum(A.PassQty) as PassQty,
           Sum(A.FailQty) as FailQty
           --, (Sum(A.PassQty) + Sum(A.FailQty)) as TotalQty
           ,case (Sum(A.PassQty) + Sum(A.FailQty)) when 0 then 1 else sum(PassQty) / (Sum(A.PassQty) + Sum(A.FailQty))  end as YieldRate
           --,Sum(A.RepassQty) RepassQty, Sum(A.RefailQty) RefailQty
  FROM R_STATION_REC_T A
  left join  R_MO_BASE_T B on A.MoNumber  = B.MoNumber
  left join  C_GROUP_CONFIG_T C on A.GroupName = C.GroupName
  join (select CM.ModelName, CM.Rev AS VersionCode ,FM.ID, FM.LevelGrade, FM.ModelClass, FM.FPYGoal, FD.FPYSeq, FD.GroupName, FD.StandardYield 
          from FpySettingM FM 
          join FpySettingD FD on FM.ID = FD.MID
          join C_MODEL_DESC_T CM on FM.ModelClass = CM.ModelClass) D on B.ModelName = D.ModelName and C.GroupName = D.GroupName
 WHERE  
 ((B.CustNo in(@CustNo)) or ('ALL' in (@CustNo))) --客戶
   AND (B.LevelGrade =@Level or 'ALL' = (@Level) )   --製程等級
   and ((WorkDate&gt;=CONVERT(nvarchar,@StartDate,112) or (@StartDate is null)))
    and  ((WorkDate &lt;=CONVERT(nvarchar,@EndDate,112)) or (@EndDate is null  )) --生產日期起迄
   and (CAST(WorkSection as int)&gt;=cast(left(@StartTime,2)as int) or @StartTime = ' ')
   and (CAST(WorkSection as int)&lt;=cast(left(@EndTime,2)as int) or @EndTime  = ' ') --時間段起迄 )
   AND (A.ModelName in (@ModelName) or 'ALL' in( @ModelName)   ) --機種
   AND (  A.LineName in(@Line_Name) or 'ALL' in (@Line_Name)) --線別
   AND (( A.MoNumber in (@WO)) or ('ALL' in (@WO)))  --工單號碼
   AND (D.ModelClass like '%'+@ModelClass+'%' or @ModelClass = 'ALL') --產品類型
 GROUP BY D.ModelClass,B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate),A.WorkDate,A.GroupName,D.FPYSeq,D.FPYGoal
 ORDER BY B.ModelName,B.DefaultLine,datepart(wk,A.WorkDate),D.FPYSeq

--select *from @TB1

declare @Type nvarchar(10) = 'ByWeek'
--,@Type1 nvarchar(10)= 'ByDay'


set @Type = @Type2

if (@Type = 'ByDay')
begin
--group by DATE
select CONVERT(datetime,WorkDate) as Date,SUM(PassQty) as PassQty,SUM(FailQty) as FailQty

--,CONVERT(float,SUM(PassQty) )/(SUM(PassQty)+SUM(FailQty)) as YieldRateByDay---update2018-4-18 17:29:02,可能發生除以零的錯誤
,case when (SUM(PassQty)+SUM(FailQty)) =0 then 1
else CONVERT(float,SUM(PassQty) )/(SUM(PassQty)+SUM(FailQty))
end as YieldRate

,AVG(FPYGoal)/100.0 as FPYGoal
 from @TB1
group by WorkDate
end

else if (@Type = 'ByWeek')
begin
--by weeks
select Weeks as Date,SUM(PassQty) as PassQty,SUM(FailQty) as FailQty
,case when (SUM(PassQty)+SUM(FailQty)) =0 then 1
else CONVERT(float,SUM(PassQty) )/(SUM(PassQty)+SUM(FailQty))
end as YieldRate
,AVG(FPYGoal)/100.0 as FPYGoal

 from @TB1
group by Weeks
end

else if (@Type = 'ByMonth')
begin
--by month
 select WorkDate as Date
 ,SUM(PassQty) as PassQty,SUM(FailQty) as FailQty
,case when (SUM(PassQty)+SUM(FailQty)) =0 then 1
else CONVERT(float,SUM(PassQty) )/(SUM(PassQty)+SUM(FailQty))
end as YieldRate
,AVG(FPYGoal)/100.0 as FPYGoal

 from 
  (
		select CONVERT(nvarchar(6),WorkDate) as WorkDate, PassQty,FailQty,FPYGoal from @TB1
 ) as GroupByMonth
 group by WorkDate
 end</CommandText>
      </Query>
      <Fields>
        <Field Name="Date">
          <DataField>Date</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="PassQty">
          <DataField>PassQty</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="FailQty">
          <DataField>FailQty</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="YieldRate">
          <DataField>YieldRate</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="FPYGoal">
          <DataField>FPYGoal</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixCorner>
              <TablixCornerRows>
                <TablixCornerRow>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox77">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>=Parameters!Type2.Value</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox77</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#7292cc</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#4c68a2</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                      <RowSpan>2</RowSpan>
                    </CellContents>
                  </TablixCornerCell>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox23">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>日期</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox23</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#7292cc</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#4c68a2</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                      <RowSpan>2</RowSpan>
                    </CellContents>
                  </TablixCornerCell>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox20">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>產品類型</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox20</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#7292cc</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#4c68a2</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                      <RowSpan>2</RowSpan>
                    </CellContents>
                  </TablixCornerCell>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox17">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>週次</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox17</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#7292cc</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#4c68a2</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                      <RowSpan>2</RowSpan>
                    </CellContents>
                  </TablixCornerCell>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox14">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>線別</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox14</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#7292cc</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#4c68a2</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                      <RowSpan>2</RowSpan>
                    </CellContents>
                  </TablixCornerCell>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox11">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>機種</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox11</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#7292cc</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#4c68a2</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                      <RowSpan>2</RowSpan>
                    </CellContents>
                  </TablixCornerCell>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox52">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>工單號碼</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox52</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#7292cc</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#4c68a2</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                      <RowSpan>2</RowSpan>
                    </CellContents>
                  </TablixCornerCell>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox7">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value />
                                <Style />
                              </TextRun>
                            </TextRuns>
                            <Style />
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox7</rd:DefaultName>
                        <Visibility>
                          <Hidden>true</Hidden>
                        </Visibility>
                        <Style>
                          <Border>
                            <Color>#4c68a2</Color>
                            <Style>None</Style>
                          </Border>
                          <BackgroundColor>#4c68a2</BackgroundColor>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixCornerCell>
                </TablixCornerRow>
                <TablixCornerRow>
                  <TablixCornerCell />
                  <TablixCornerCell />
                  <TablixCornerCell />
                  <TablixCornerCell />
                  <TablixCornerCell />
                  <TablixCornerCell />
                  <TablixCornerCell />
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox45">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value />
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style />
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox45</rd:DefaultName>
                        <Visibility>
                          <Hidden>true</Hidden>
                        </Visibility>
                        <Style>
                          <Border>
                            <Color>#7292cc</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#4c68a2</BackgroundColor>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixCornerCell>
                </TablixCornerRow>
              </TablixCornerRows>
            </TablixCorner>
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>16.00417mm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>15.21042mm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>23.27708mm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>25mm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>25mm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>6mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="PassQty">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=IIf(Sum(Fields!PassQty.Value)+Sum(Fields!FailQty.Value)=0,Nothing,Sum(Fields!PassQty.Value))</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>PassQty</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="FailQty">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=IIf(Sum(Fields!PassQty.Value)+Sum(Fields!FailQty.Value)=0,Nothing,Sum(Fields!FailQty.Value))</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>FailQty</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="YieldRate">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.Product(IIf(IsNothing(Sum(Fields!YieldRate.Value)),1,Sum(Fields!YieldRate.Value) ), ReportItems("groupForYieldRate").Value)</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>0.00%</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>YieldRate</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox30">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.ProductValue</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>0.00%</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox30</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="FPYGoal">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!FPYGoal.Value)/100</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>0.00%</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>FPYGoal</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>6mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="PassQty1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!PassQty.Value)</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>PassQty1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Khaki</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="FailQty1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!FailQty.Value)</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>FailQty1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Khaki</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="yieldRateForVertical">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.Product1(IIf(IsNothing(Sum(Fields!FailQty.Value)) And IsNothing(Sum(Fields!PassQty.Value))Or (Sum(Fields!FailQty.Value)+Sum(Fields!PassQty.Value)= 0)
, 1,Sum(Fields!PassQty.Value)/(Sum(Fields!FailQty.Value)+Sum(Fields!PassQty.Value))) , ReportItems("DateType").Value)</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>0.00%</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>yieldRateForVertical</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>Khaki</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox88">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.ProductValue1</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>0.00%</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox88</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>PaleTurquoise</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox89">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!FPYGoal.Value)/100</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>0.00%</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox89</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>PaleTurquoise</BackgroundColor>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="GroupName">
                    <GroupExpressions>
                      <GroupExpression>=Fields!GroupName.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!GroupName.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <TablixHeader>
                    <Size>6mm</Size>
                    <CellContents>
                      <Textbox Name="GroupName">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>=Fields!GroupName.Value</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>#465678</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>GroupName</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#c6daf8</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#9eb6e4</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <TablixMember>
                      <TablixHeader>
                        <Size>6mm</Size>
                        <CellContents>
                          <Textbox Name="Textbox3">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>Output</Value>
                                    <Style>
                                      <FontFamily>Tahoma</FontFamily>
                                      <FontSize>11pt</FontSize>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>White</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style />
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox3</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>#7292cc</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>#4c68a2</BackgroundColor>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                      <TablixMembers>
                        <TablixMember />
                      </TablixMembers>
                    </TablixMember>
                    <TablixMember>
                      <TablixHeader>
                        <Size>6mm</Size>
                        <CellContents>
                          <Textbox Name="Textbox5">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>Defect</Value>
                                    <Style>
                                      <FontFamily>Tahoma</FontFamily>
                                      <FontSize>11pt</FontSize>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>White</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style />
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox5</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>#7292cc</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>#4c68a2</BackgroundColor>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                    </TablixMember>
                    <TablixMember>
                      <TablixHeader>
                        <Size>6mm</Size>
                        <CellContents>
                          <Textbox Name="Textbox8">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>Yield Rate</Value>
                                    <Style>
                                      <FontFamily>Tahoma</FontFamily>
                                      <FontSize>11pt</FontSize>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>White</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style />
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox8</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>#7292cc</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>#4c68a2</BackgroundColor>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
                <TablixMember>
                  <TablixHeader>
                    <Size>6mm</Size>
                    <CellContents>
                      <Textbox Name="Textbox28">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>FPY</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>#465678</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox28</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#c6daf8</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#9eb6e4</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <TablixMember>
                      <TablixHeader>
                        <Size>6mm</Size>
                        <CellContents>
                          <Textbox Name="Textbox29">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>Actual</Value>
                                    <Style>
                                      <FontFamily>Tahoma</FontFamily>
                                      <FontSize>11pt</FontSize>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>White</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style />
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox29</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>#7292cc</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>#4c68a2</BackgroundColor>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                    </TablixMember>
                    <TablixMember>
                      <TablixHeader>
                        <Size>6mm</Size>
                        <CellContents>
                          <Textbox Name="Textbox32">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>Goal</Value>
                                    <Style>
                                      <FontFamily>Tahoma</FontFamily>
                                      <FontSize>11pt</FontSize>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>White</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style />
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox32</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>#7292cc</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>#4c68a2</BackgroundColor>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="DateType">
                    <GroupExpressions>
                      <GroupExpression>=Fields!DateType.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!DateType.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <TablixHeader>
                    <Size>25mm</Size>
                    <CellContents>
                      <Textbox Name="DateType">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>=Fields!DateType.Value</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>#465678</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>DateType</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#c6daf8</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#9eb6e4</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <TablixMember>
                      <Group Name="WorkDate">
                        <GroupExpressions>
                          <GroupExpression>=Fields!WorkDate.Value</GroupExpression>
                        </GroupExpressions>
                      </Group>
                      <SortExpressions>
                        <SortExpression>
                          <Value>=Fields!WorkDate.Value</Value>
                        </SortExpression>
                      </SortExpressions>
                      <TablixHeader>
                        <Size>22.88333mm</Size>
                        <CellContents>
                          <Textbox Name="WorkDate">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>=Fields!WorkDate.Value</Value>
                                    <Style>
                                      <FontFamily>Tahoma</FontFamily>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>#465678</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style />
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>WorkDate</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>#c6daf8</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>#9eb6e4</BackgroundColor>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                      <TablixMembers>
                        <TablixMember>
                          <Group Name="ModelClass">
                            <GroupExpressions>
                              <GroupExpression>=Fields!ModelClass.Value</GroupExpression>
                            </GroupExpressions>
                          </Group>
                          <SortExpressions>
                            <SortExpression>
                              <Value>=Fields!ModelClass.Value</Value>
                            </SortExpression>
                          </SortExpressions>
                          <TablixHeader>
                            <Size>19.16667mm</Size>
                            <CellContents>
                              <Textbox Name="ModelClass">
                                <CanGrow>true</CanGrow>
                                <KeepTogether>true</KeepTogether>
                                <Paragraphs>
                                  <Paragraph>
                                    <TextRuns>
                                      <TextRun>
                                        <Value>=Fields!ModelClass.Value</Value>
                                        <Style>
                                          <FontFamily>Tahoma</FontFamily>
                                          <FontWeight>Bold</FontWeight>
                                          <Color>#4c68a2</Color>
                                        </Style>
                                      </TextRun>
                                    </TextRuns>
                                    <Style />
                                  </Paragraph>
                                </Paragraphs>
                                <rd:DefaultName>ModelClass</rd:DefaultName>
                                <Style>
                                  <Border>
                                    <Color>#e6eefc</Color>
                                    <Style>Solid</Style>
                                  </Border>
                                  <BackgroundColor>#c6daf8</BackgroundColor>
                                  <PaddingLeft>2pt</PaddingLeft>
                                  <PaddingRight>2pt</PaddingRight>
                                  <PaddingTop>2pt</PaddingTop>
                                  <PaddingBottom>2pt</PaddingBottom>
                                </Style>
                              </Textbox>
                            </CellContents>
                          </TablixHeader>
                          <TablixMembers>
                            <TablixMember>
                              <Group Name="Weeks">
                                <GroupExpressions>
                                  <GroupExpression>=Fields!Weeks.Value</GroupExpression>
                                </GroupExpressions>
                              </Group>
                              <SortExpressions>
                                <SortExpression>
                                  <Value>=Fields!Weeks.Value</Value>
                                </SortExpression>
                              </SortExpressions>
                              <TablixHeader>
                                <Size>16.00417mm</Size>
                                <CellContents>
                                  <Textbox Name="Weeks">
                                    <CanGrow>true</CanGrow>
                                    <KeepTogether>true</KeepTogether>
                                    <Paragraphs>
                                      <Paragraph>
                                        <TextRuns>
                                          <TextRun>
                                            <Value>=Fields!Weeks.Value</Value>
                                            <Style>
                                              <FontFamily>Tahoma</FontFamily>
                                              <FontWeight>Bold</FontWeight>
                                              <Color>#4c68a2</Color>
                                            </Style>
                                          </TextRun>
                                        </TextRuns>
                                        <Style />
                                      </Paragraph>
                                    </Paragraphs>
                                    <rd:DefaultName>Weeks</rd:DefaultName>
                                    <Style>
                                      <Border>
                                        <Color>White</Color>
                                        <Style>Solid</Style>
                                      </Border>
                                      <BackgroundColor>#e6eefc</BackgroundColor>
                                      <PaddingLeft>2pt</PaddingLeft>
                                      <PaddingRight>2pt</PaddingRight>
                                      <PaddingTop>2pt</PaddingTop>
                                      <PaddingBottom>2pt</PaddingBottom>
                                    </Style>
                                  </Textbox>
                                </CellContents>
                              </TablixHeader>
                              <TablixMembers>
                                <TablixMember>
                                  <Group Name="DefaultLine">
                                    <GroupExpressions>
                                      <GroupExpression>=Fields!DefaultLine.Value</GroupExpression>
                                    </GroupExpressions>
                                  </Group>
                                  <SortExpressions>
                                    <SortExpression>
                                      <Value>=Fields!DefaultLine.Value</Value>
                                    </SortExpression>
                                  </SortExpressions>
                                  <TablixHeader>
                                    <Size>16.26875mm</Size>
                                    <CellContents>
                                      <Textbox Name="DefaultLine">
                                        <CanGrow>true</CanGrow>
                                        <KeepTogether>true</KeepTogether>
                                        <Paragraphs>
                                          <Paragraph>
                                            <TextRuns>
                                              <TextRun>
                                                <Value>=Fields!DefaultLine.Value</Value>
                                                <Style>
                                                  <FontFamily>Tahoma</FontFamily>
                                                  <FontWeight>Bold</FontWeight>
                                                  <Color>#4c68a2</Color>
                                                </Style>
                                              </TextRun>
                                            </TextRuns>
                                            <Style />
                                          </Paragraph>
                                        </Paragraphs>
                                        <rd:DefaultName>DefaultLine</rd:DefaultName>
                                        <Style>
                                          <Border>
                                            <Color>White</Color>
                                            <Style>Solid</Style>
                                          </Border>
                                          <BackgroundColor>#e6eefc</BackgroundColor>
                                          <PaddingLeft>2pt</PaddingLeft>
                                          <PaddingRight>2pt</PaddingRight>
                                          <PaddingTop>2pt</PaddingTop>
                                          <PaddingBottom>2pt</PaddingBottom>
                                        </Style>
                                      </Textbox>
                                    </CellContents>
                                  </TablixHeader>
                                  <TablixMembers>
                                    <TablixMember>
                                      <Group Name="ModelName">
                                        <GroupExpressions>
                                          <GroupExpression>=Fields!ModelName.Value</GroupExpression>
                                        </GroupExpressions>
                                      </Group>
                                      <SortExpressions>
                                        <SortExpression>
                                          <Value>=Fields!ModelName.Value</Value>
                                        </SortExpression>
                                      </SortExpressions>
                                      <TablixHeader>
                                        <Size>52.66458mm</Size>
                                        <CellContents>
                                          <Textbox Name="ModelName">
                                            <CanGrow>true</CanGrow>
                                            <KeepTogether>true</KeepTogether>
                                            <Paragraphs>
                                              <Paragraph>
                                                <TextRuns>
                                                  <TextRun>
                                                    <Value>=Fields!ModelName.Value</Value>
                                                    <Style>
                                                      <FontFamily>Tahoma</FontFamily>
                                                      <FontWeight>Bold</FontWeight>
                                                      <Color>#4c68a2</Color>
                                                    </Style>
                                                  </TextRun>
                                                </TextRuns>
                                                <Style />
                                              </Paragraph>
                                            </Paragraphs>
                                            <rd:DefaultName>ModelName</rd:DefaultName>
                                            <Style>
                                              <Border>
                                                <Color>White</Color>
                                                <Style>Solid</Style>
                                              </Border>
                                              <BackgroundColor>#e6eefc</BackgroundColor>
                                              <PaddingLeft>2pt</PaddingLeft>
                                              <PaddingRight>2pt</PaddingRight>
                                              <PaddingTop>2pt</PaddingTop>
                                              <PaddingBottom>2pt</PaddingBottom>
                                            </Style>
                                          </Textbox>
                                        </CellContents>
                                      </TablixHeader>
                                      <TablixMembers>
                                        <TablixMember>
                                          <Group Name="MoNumber1">
                                            <GroupExpressions>
                                              <GroupExpression>=Fields!MoNumber.Value</GroupExpression>
                                            </GroupExpressions>
                                          </Group>
                                          <SortExpressions>
                                            <SortExpression>
                                              <Value>=Fields!MoNumber.Value</Value>
                                            </SortExpression>
                                          </SortExpressions>
                                          <TablixHeader>
                                            <Size>25mm</Size>
                                            <CellContents>
                                              <Textbox Name="MoNumber11">
                                                <CanGrow>true</CanGrow>
                                                <KeepTogether>true</KeepTogether>
                                                <Paragraphs>
                                                  <Paragraph>
                                                    <TextRuns>
                                                      <TextRun>
                                                        <Value>=Fields!MoNumber.Value</Value>
                                                        <Style>
                                                          <FontFamily>Tahoma</FontFamily>
                                                          <FontWeight>Bold</FontWeight>
                                                          <Color>#4c68a2</Color>
                                                        </Style>
                                                      </TextRun>
                                                    </TextRuns>
                                                    <Style />
                                                  </Paragraph>
                                                </Paragraphs>
                                                <rd:DefaultName>MoNumber11</rd:DefaultName>
                                                <Style>
                                                  <Border>
                                                    <Color>White</Color>
                                                    <Style>Solid</Style>
                                                  </Border>
                                                  <BackgroundColor>#e6eefc</BackgroundColor>
                                                  <PaddingLeft>2pt</PaddingLeft>
                                                  <PaddingRight>2pt</PaddingRight>
                                                  <PaddingTop>2pt</PaddingTop>
                                                  <PaddingBottom>2pt</PaddingBottom>
                                                </Style>
                                              </Textbox>
                                            </CellContents>
                                          </TablixHeader>
                                          <TablixMembers>
                                            <TablixMember>
                                              <Group Name="groupForYieldRate">
                                                <GroupExpressions>
                                                  <GroupExpression>=Fields!groupForYieldRate.Value</GroupExpression>
                                                </GroupExpressions>
                                              </Group>
                                              <SortExpressions>
                                                <SortExpression>
                                                  <Value>=Fields!groupForYieldRate.Value</Value>
                                                </SortExpression>
                                              </SortExpressions>
                                              <TablixHeader>
                                                <Size>0.79375mm</Size>
                                                <CellContents>
                                                  <Textbox Name="groupForYieldRate">
                                                    <CanGrow>true</CanGrow>
                                                    <KeepTogether>true</KeepTogether>
                                                    <Paragraphs>
                                                      <Paragraph>
                                                        <TextRuns>
                                                          <TextRun>
                                                            <Value>=Fields!groupForYieldRate.Value</Value>
                                                            <Style>
                                                              <FontFamily>Tahoma</FontFamily>
                                                              <FontWeight>Bold</FontWeight>
                                                              <Color>#4c68a2</Color>
                                                            </Style>
                                                          </TextRun>
                                                        </TextRuns>
                                                        <Style />
                                                      </Paragraph>
                                                    </Paragraphs>
                                                    <rd:DefaultName>groupForYieldRate</rd:DefaultName>
                                                    <Visibility>
                                                      <Hidden>true</Hidden>
                                                    </Visibility>
                                                    <Style>
                                                      <Border>
                                                        <Color>White</Color>
                                                        <Style>Solid</Style>
                                                      </Border>
                                                      <BackgroundColor>#e6eefc</BackgroundColor>
                                                      <PaddingLeft>2pt</PaddingLeft>
                                                      <PaddingRight>2pt</PaddingRight>
                                                      <PaddingTop>2pt</PaddingTop>
                                                      <PaddingBottom>2pt</PaddingBottom>
                                                    </Style>
                                                  </Textbox>
                                                </CellContents>
                                              </TablixHeader>
                                              <TablixMembers>
                                                <TablixMember />
                                              </TablixMembers>
                                            </TablixMember>
                                          </TablixMembers>
                                        </TablixMember>
                                      </TablixMembers>
                                    </TablixMember>
                                  </TablixMembers>
                                </TablixMember>
                              </TablixMembers>
                            </TablixMember>
                          </TablixMembers>
                        </TablixMember>
                      </TablixMembers>
                    </TablixMember>
                    <TablixMember>
                      <TablixHeader>
                        <Size>151.9875mm</Size>
                        <CellContents>
                          <Textbox Name="Textbox80">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>良率匯總: </Value>
                                    <Style>
                                      <FontFamily>Tahoma</FontFamily>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>#465678</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style>
                                  <TextAlign>Center</TextAlign>
                                </Style>
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox80</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>#c6daf8</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>Tan</BackgroundColor>
                              <VerticalAlign>Middle</VerticalAlign>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                      <TablixMembers>
                        <TablixMember>
                          <TablixHeader>
                            <Size>0.79375mm</Size>
                            <CellContents>
                              <Textbox Name="Textbox12">
                                <CanGrow>true</CanGrow>
                                <KeepTogether>true</KeepTogether>
                                <Paragraphs>
                                  <Paragraph>
                                    <TextRuns>
                                      <TextRun>
                                        <Value />
                                        <Style>
                                          <FontFamily>Tahoma</FontFamily>
                                          <FontWeight>Bold</FontWeight>
                                          <Color>#465678</Color>
                                        </Style>
                                      </TextRun>
                                    </TextRuns>
                                    <Style>
                                      <TextAlign>Center</TextAlign>
                                    </Style>
                                  </Paragraph>
                                </Paragraphs>
                                <rd:DefaultName>Textbox12</rd:DefaultName>
                                <Visibility>
                                  <Hidden>true</Hidden>
                                </Visibility>
                                <Style>
                                  <Border>
                                    <Color>#c6daf8</Color>
                                    <Style>Solid</Style>
                                  </Border>
                                  <BackgroundColor>Tan</BackgroundColor>
                                  <VerticalAlign>Middle</VerticalAlign>
                                  <PaddingLeft>2pt</PaddingLeft>
                                  <PaddingRight>2pt</PaddingRight>
                                  <PaddingTop>2pt</PaddingTop>
                                  <PaddingBottom>2pt</PaddingBottom>
                                </Style>
                              </Textbox>
                            </CellContents>
                          </TablixHeader>
                          <TablixMembers>
                            <TablixMember />
                          </TablixMembers>
                        </TablixMember>
                      </TablixMembers>
                      <KeepWithGroup>Before</KeepWithGroup>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <RepeatColumnHeaders>true</RepeatColumnHeaders>
            <RepeatRowHeaders>true</RepeatRowHeaders>
            <FixedColumnHeaders>true</FixedColumnHeaders>
            <FixedRowHeaders>true</FixedRowHeaders>
            <DataSetName>DataSet1</DataSetName>
            <Top>11.92389mm</Top>
            <Left>0mm</Left>
            <Height>24mm</Height>
            <Width>282.27292mm</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
          <Chart Name="Chart1">
            <ChartCategoryHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Group Name="Chart1_CategoryGroup">
                    <GroupExpressions>
                      <GroupExpression>=Fields!DateType.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!DateType.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <Label>=Fields!DateType.Value</Label>
                </ChartMember>
              </ChartMembers>
            </ChartCategoryHierarchy>
            <ChartSeriesHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Label>yield Rate For Chart</Label>
                </ChartMember>
                <ChartMember>
                  <Label>FPYGoal</Label>
                </ChartMember>
              </ChartMembers>
            </ChartSeriesHierarchy>
            <ChartData>
              <ChartSeriesCollection>
                <ChartSeries Name="YieldRate">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=First(Fields!yieldRateForChart.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style>
                          <Format>0%</Format>
                        </Style>
                        <UseValueAsLabel>true</UseValueAsLabel>
                        <Visible>true</Visible>
                      </ChartDataLabel>
                      <Style>
                        <Border>
                          <Width>2pt</Width>
                        </Border>
                        <Color>Tan</Color>
                      </Style>
                      <ChartMarker>
                        <Type>Circle</Type>
                        <Size>5pt</Size>
                        <Style>
                          <Border>
                            <Color>White</Color>
                          </Border>
                        </Style>
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Line</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ChartItemInLegend>
                    <LegendText>FPY</LegendText>
                  </ChartItemInLegend>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
                <ChartSeries Name="FPYGoal">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=First(Fields!FPYGoal.Value)/100</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style>
                          <Format>0.00%</Format>
                        </Style>
                      </ChartDataLabel>
                      <Style>
                        <Border>
                          <Width>2pt</Width>
                        </Border>
                        <Color>Red</Color>
                      </Style>
                      <ChartMarker>
                        <Size>4pt</Size>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Line</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ChartItemInLegend>
                    <LegendText>Goal</LegendText>
                  </ChartItemInLegend>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
              </ChartSeriesCollection>
            </ChartData>
            <ChartAreas>
              <ChartArea Name="Default">
                <ChartCategoryAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                      </Border>
                      <FontFamily>Tahoma</FontFamily>
                      <FontSize>8pt</FontSize>
                      <Format>yyyy/M/d</Format>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>日期</Caption>
                      <Style>
                        <FontFamily>Tahoma</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <IntervalType>Days</IntervalType>
                    <ChartMajorGridLines>
                      <Enabled>True</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Enabled>True</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMajorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                      <Interval>1</Interval>
                    </ChartMajorTickMarks>
                    <ChartMinorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Scalar>true</Scalar>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <Angle>90</Angle>
                    <PreventLabelOffset>true</PreventLabelOffset>
                    <PreventWordWrap>true</PreventWordWrap>
                    <IncludeZero>false</IncludeZero>
                    <MinFontSize>5pt</MinFontSize>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                      </Border>
                      <FontFamily>Tahoma</FontFamily>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontFamily>Tahoma</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMajorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                    </ChartMajorTickMarks>
                    <ChartMinorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartCategoryAxes>
                <ChartValueAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                      </Border>
                      <FontFamily>Tahoma</FontFamily>
                      <FontSize>8pt</FontSize>
                      <Format>0.00%</Format>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>良率</Caption>
                      <Style>
                        <FontFamily>Tahoma</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMajorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                    </ChartMajorTickMarks>
                    <ChartMinorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>1</Maximum>
                    <IncludeZero>false</IncludeZero>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                      </Border>
                      <FontFamily>Tahoma</FontFamily>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontFamily>Tahoma</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMajorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                    </ChartMajorTickMarks>
                    <ChartMinorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartValueAxes>
                <Style>
                  <BackgroundColor>#e6eefc</BackgroundColor>
                  <BackgroundGradientType>None</BackgroundGradientType>
                </Style>
              </ChartArea>
            </ChartAreas>
            <ChartLegends>
              <ChartLegend Name="Default">
                <Style>
                  <Border>
                    <Color>#7292cc</Color>
                  </Border>
                  <BackgroundColor>#e6eefc</BackgroundColor>
                  <BackgroundGradientType>TopBottom</BackgroundGradientType>
                  <BackgroundGradientEndColor>#c6daf8</BackgroundGradientEndColor>
                  <FontFamily>Tahoma</FontFamily>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartLegendTitle>
                  <Caption />
                  <Style>
                    <FontFamily>Tahoma</FontFamily>
                    <FontSize>8pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </ChartLegendTitle>
                <HeaderSeparatorColor>Black</HeaderSeparatorColor>
                <ColumnSeparatorColor>Black</ColumnSeparatorColor>
              </ChartLegend>
            </ChartLegends>
            <ChartTitles>
              <ChartTitle Name="Default">
                <Caption>良率分析圖(ByDay)</Caption>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontFamily>Tahoma</FontFamily>
                  <FontSize>14pt</FontSize>
                  <FontWeight>Bold</FontWeight>
                  <TextAlign>General</TextAlign>
                  <VerticalAlign>Top</VerticalAlign>
                </Style>
              </ChartTitle>
            </ChartTitles>
            <Palette>Custom</Palette>
            <ChartCustomPaletteColors>
              <ChartCustomPaletteColor>#4c68a2</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#b5dddf</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#7292cc</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#89bcc5</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#c4d5f3</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#c6c595</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#87acf3</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#7b9291</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#a8c4ec</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#a49ed4</ChartCustomPaletteColor>
            </ChartCustomPaletteColors>
            <ChartBorderSkin>
              <ChartBorderSkinType>Emboss</ChartBorderSkinType>
              <Style>
                <BackgroundColor>Gray</BackgroundColor>
                <BackgroundGradientType>None</BackgroundGradientType>
                <Color>White</Color>
              </Style>
            </ChartBorderSkin>
            <ChartNoDataMessage Name="NoDataMessage">
              <Caption>沒有可用資料</Caption>
              <Style>
                <BackgroundGradientType>None</BackgroundGradientType>
                <FontFamily>Tahoma</FontFamily>
                <FontSize>8pt</FontSize>
                <TextAlign>General</TextAlign>
                <VerticalAlign>Top</VerticalAlign>
              </Style>
            </ChartNoDataMessage>
            <DataSetName>DataSet1</DataSetName>
            <Top>39.09889mm</Top>
            <Left>0mm</Left>
            <Height>118.93278mm</Height>
            <Width>400.04376mm</Width>
            <ZIndex>1</ZIndex>
            <Visibility>
              <Hidden>=IIf(Parameters!Type2.Value = "ByDay", False,True)</Hidden>
            </Visibility>
            <Style>
              <Border>
                <Color>#7292cc</Color>
                <Style>Solid</Style>
                <Width>2pt</Width>
              </Border>
              <BackgroundColor>#c6daf8</BackgroundColor>
              <BackgroundGradientType>TopBottom</BackgroundGradientType>
              <BackgroundGradientEndColor>#e6eefc</BackgroundGradientEndColor>
            </Style>
          </Chart>
          <Textbox Name="ReportTitle">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value />
                    <Style>
                      <FontFamily>Verdana</FontFamily>
                      <FontSize>20pt</FontSize>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <rd:WatermarkTextbox>Title</rd:WatermarkTextbox>
            <rd:DefaultName>ReportTitle</rd:DefaultName>
            <Top>0mm</Top>
            <Height>10.16mm</Height>
            <Width>139.7mm</Width>
            <ZIndex>2</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Chart Name="Chart2">
            <ChartCategoryHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Group Name="Chart2_CategoryGroup">
                    <GroupExpressions>
                      <GroupExpression>=Fields!DateType.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!DateType.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <Label>=Fields!DateType.Value</Label>
                </ChartMember>
              </ChartMembers>
            </ChartCategoryHierarchy>
            <ChartSeriesHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Label>yield Rate For Chart</Label>
                </ChartMember>
                <ChartMember>
                  <Label>FPYGoal</Label>
                </ChartMember>
              </ChartMembers>
            </ChartSeriesHierarchy>
            <ChartData>
              <ChartSeriesCollection>
                <ChartSeries Name="YieldRate">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=First(Fields!yieldRateForChart.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style>
                          <Format>0%</Format>
                        </Style>
                        <UseValueAsLabel>true</UseValueAsLabel>
                        <Visible>true</Visible>
                      </ChartDataLabel>
                      <Style>
                        <Border>
                          <Width>2pt</Width>
                        </Border>
                        <Color>Tan</Color>
                      </Style>
                      <ChartMarker>
                        <Type>Circle</Type>
                        <Size>5pt</Size>
                        <Style>
                          <Border>
                            <Color>White</Color>
                          </Border>
                        </Style>
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Line</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ChartItemInLegend>
                    <LegendText>FPY</LegendText>
                  </ChartItemInLegend>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
                <ChartSeries Name="FPYGoal">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=First(Fields!FPYGoal.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style />
                      </ChartDataLabel>
                      <Style>
                        <Border>
                          <Width>2pt</Width>
                        </Border>
                        <Color>Red</Color>
                      </Style>
                      <ChartMarker>
                        <Size>4pt</Size>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Line</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ChartItemInLegend>
                    <LegendText>Goal</LegendText>
                  </ChartItemInLegend>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
              </ChartSeriesCollection>
            </ChartData>
            <ChartAreas>
              <ChartArea Name="Default">
                <ChartCategoryAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                      </Border>
                      <FontFamily>Tahoma</FontFamily>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>日期</Caption>
                      <Style>
                        <FontFamily>Tahoma</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <IntervalType>Default</IntervalType>
                    <ChartMajorGridLines>
                      <Enabled>True</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Enabled>True</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMajorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                      <Interval>1</Interval>
                    </ChartMajorTickMarks>
                    <ChartMinorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <Angle>90</Angle>
                    <PreventLabelOffset>true</PreventLabelOffset>
                    <PreventWordWrap>true</PreventWordWrap>
                    <IncludeZero>false</IncludeZero>
                    <MinFontSize>5pt</MinFontSize>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                      </Border>
                      <FontFamily>Tahoma</FontFamily>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontFamily>Tahoma</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMajorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                    </ChartMajorTickMarks>
                    <ChartMinorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartCategoryAxes>
                <ChartValueAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                      </Border>
                      <FontFamily>Tahoma</FontFamily>
                      <FontSize>8pt</FontSize>
                      <Format>0.00%</Format>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>良率</Caption>
                      <Style>
                        <FontFamily>Tahoma</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMajorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                    </ChartMajorTickMarks>
                    <ChartMinorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>1</Maximum>
                    <IncludeZero>false</IncludeZero>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                      </Border>
                      <FontFamily>Tahoma</FontFamily>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontFamily>Tahoma</FontFamily>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMajorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                    </ChartMajorTickMarks>
                    <ChartMinorTickMarks>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                        </Border>
                      </Style>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartValueAxes>
                <Style>
                  <BackgroundColor>#e6eefc</BackgroundColor>
                  <BackgroundGradientType>None</BackgroundGradientType>
                </Style>
              </ChartArea>
            </ChartAreas>
            <ChartLegends>
              <ChartLegend Name="Default">
                <Style>
                  <Border>
                    <Color>#7292cc</Color>
                  </Border>
                  <BackgroundColor>#e6eefc</BackgroundColor>
                  <BackgroundGradientType>TopBottom</BackgroundGradientType>
                  <BackgroundGradientEndColor>#c6daf8</BackgroundGradientEndColor>
                  <FontFamily>Tahoma</FontFamily>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartLegendTitle>
                  <Caption />
                  <Style>
                    <FontFamily>Tahoma</FontFamily>
                    <FontSize>8pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </ChartLegendTitle>
                <HeaderSeparatorColor>Black</HeaderSeparatorColor>
                <ColumnSeparatorColor>Black</ColumnSeparatorColor>
              </ChartLegend>
            </ChartLegends>
            <ChartTitles>
              <ChartTitle Name="Default">
                <Caption>="良率分析圖("+Parameters!Type2.Value+")"</Caption>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontFamily>Tahoma</FontFamily>
                  <FontSize>14pt</FontSize>
                  <FontWeight>Bold</FontWeight>
                  <TextAlign>General</TextAlign>
                  <VerticalAlign>Top</VerticalAlign>
                </Style>
              </ChartTitle>
            </ChartTitles>
            <Palette>Custom</Palette>
            <ChartCustomPaletteColors>
              <ChartCustomPaletteColor>#4c68a2</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#b5dddf</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#7292cc</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#89bcc5</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#c4d5f3</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#c6c595</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#87acf3</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#7b9291</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#a8c4ec</ChartCustomPaletteColor>
              <ChartCustomPaletteColor>#a49ed4</ChartCustomPaletteColor>
            </ChartCustomPaletteColors>
            <ChartBorderSkin>
              <ChartBorderSkinType>Emboss</ChartBorderSkinType>
              <Style>
                <BackgroundColor>Gray</BackgroundColor>
                <BackgroundGradientType>None</BackgroundGradientType>
                <Color>White</Color>
              </Style>
            </ChartBorderSkin>
            <ChartNoDataMessage Name="NoDataMessage">
              <Caption>沒有可用資料</Caption>
              <Style>
                <BackgroundGradientType>None</BackgroundGradientType>
                <FontFamily>Tahoma</FontFamily>
                <FontSize>8pt</FontSize>
                <TextAlign>General</TextAlign>
                <VerticalAlign>Top</VerticalAlign>
              </Style>
            </ChartNoDataMessage>
            <DataSetName>DataSet1</DataSetName>
            <Top>163.50117mm</Top>
            <Left>14.81667mm</Left>
            <Height>118.93278mm</Height>
            <Width>400.04376mm</Width>
            <ZIndex>3</ZIndex>
            <Visibility>
              <Hidden>=IIf(Parameters!Type2.Value &lt;&gt; "ByDay", False,True)</Hidden>
            </Visibility>
            <Style>
              <Border>
                <Color>#7292cc</Color>
                <Style>Solid</Style>
                <Width>2pt</Width>
              </Border>
              <BackgroundColor>#c6daf8</BackgroundColor>
              <BackgroundGradientType>TopBottom</BackgroundGradientType>
              <BackgroundGradientEndColor>#e6eefc</BackgroundGradientEndColor>
            </Style>
          </Chart>
        </ReportItems>
        <Height>290.08849mm</Height>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Body>
      <Width>414.86043mm</Width>
      <Page>
        <PageFooter>
          <Height>11.95917mm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="ExecutionTime">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Globals!ExecutionTime</Value>
                      <Style />
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>ExecutionTime</rd:DefaultName>
              <Top>5.08mm</Top>
              <Left>101.98125mm</Left>
              <Height>6.35mm</Height>
              <Width>50.8mm</Width>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageFooter>
        <PageHeight>29.7cm</PageHeight>
        <PageWidth>21cm</PageWidth>
        <LeftMargin>2cm</LeftMargin>
        <RightMargin>2cm</RightMargin>
        <TopMargin>2cm</TopMargin>
        <BottomMargin>2cm</BottomMargin>
        <ColumnSpacing>0.13cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="WO">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ALL</Value>
        </Values>
      </DefaultValue>
      <Prompt>工單號碼</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>ListWO</DataSetName>
          <ValueField>MoNumber</ValueField>
          <LabelField>MoNumber</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="ModelName">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ALL</Value>
        </Values>
      </DefaultValue>
      <Prompt>機種</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>ListModelName</DataSetName>
          <ValueField>ModelName</ValueField>
          <LabelField>ModelName</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="ModelClass">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>DeskTop</Value>
        </Values>
      </DefaultValue>
      <Prompt>產品類型</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>ListModelClass1</DataSetName>
          <ValueField>ModelClass</ValueField>
          <LabelField>ModelClass</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="CustNo">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ALL</Value>
        </Values>
      </DefaultValue>
      <Prompt>客戶</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>ListCustNo</DataSetName>
          <ValueField>CustNo</ValueField>
          <LabelField>Customer</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="Line_Name">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ALL</Value>
        </Values>
      </DefaultValue>
      <Prompt>線別</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>ListLineName</DataSetName>
          <ValueField>LineName</ValueField>
          <LabelField>LineName</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="Level">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>L10</Value>
        </Values>
      </DefaultValue>
      <Prompt>製造等級</Prompt>
    </ReportParameter>
    <ReportParameter Name="StartDate">
      <DataType>DateTime</DataType>
      <Prompt>生產日期起</Prompt>
    </ReportParameter>
    <ReportParameter Name="EndDate">
      <DataType>DateTime</DataType>
      <Nullable>true</Nullable>
      <Prompt>生產日期迄</Prompt>
    </ReportParameter>
    <ReportParameter Name="StartTime">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>時間</DataSetName>
          <ValueField>times</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>時間段起</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>時間</DataSetName>
          <ValueField>times</ValueField>
          <LabelField>times</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="EndTime">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>時間</DataSetName>
          <ValueField>times</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>時間段迄</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>時間</DataSetName>
          <ValueField>times</ValueField>
          <LabelField>times</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="Type2">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>ByDay</Value>
        </Values>
      </DefaultValue>
      <Prompt>圖表類型</Prompt>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>ByDay</Value>
            <Label>By Day</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>ByWeek</Value>
            <Label>By Week</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>ByMonth</Value>
            <Label>By Month</Label>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
  </ReportParameters>
  <Code>    Public ProductValue2 As Double = 1.0
    Public CurrentGroupName2 As String

    Public Function Product2(ItemValue As Double, ByVal ItemGroupName As String) As Double
        If (ItemValue &gt;= 0) Then
            If (CurrentGroupName2 = ItemGroupName) Then
                ProductValue2 = ProductValue2 * ItemValue
            Else
                CurrentGroupName2 = ItemGroupName
                ProductValue2 = ItemValue
            End If
        End If
        Return ItemValue
    End Function


    Public sngColumnA As Single = 1.0
    Public sngColumnB As Single = 1.0
    Public sngYieldRate As Single = 1.0

    Public Function fnMultiPly(sngTemp As Single, ByRef sngFinal As Single) As Single
        If (IsNothing(sngTemp)) Then
            sngTemp = 1.0

        End If
        sngFinal = sngFinal * sngTemp
        Return sngTemp
    End Function


    Public ProductValue As Double = 1.0
    Public CurrentGroupName As String

    Public Function Product(ItemValue As Double, ByVal ItemGroupName As String) As Double


        If (ItemValue &gt;= 0) Then
            If (CurrentGroupName = ItemGroupName) Then
                ProductValue = ProductValue * ItemValue
            Else
                CurrentGroupName = ItemGroupName
                ProductValue = ItemValue
            End If
        End If
        Return ItemValue
    End Function

    Public ProductValue1 As Double = 1.0
    Public CurrentGroupName1 As String

    Public Function Product1(ItemValue As Double, ByVal ItemGroupName As String) As Double
        If (ItemValue &gt;= 0) Then
            If (CurrentGroupName1 = ItemGroupName) Then
                ProductValue1 = ProductValue1 * ItemValue
            Else
                CurrentGroupName1 = ItemGroupName
                ProductValue1 = ItemValue
            End If
        End If
        Return ItemValue
    End Function



</Code>
  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportServerUrl>http://10.62.197.16/ReportServer</rd:ReportServerUrl>
  <rd:ReportID>74ca3aaa-f303-4c66-8400-3fd751f433a1</rd:ReportID>
</Report>