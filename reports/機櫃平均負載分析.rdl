<?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:cl="http://schemas.microsoft.com/sqlserver/reporting/2010/01/componentdefinition" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource1">
      <DataSourceReference>/PDSS Reports/教學報表/DCMP/DCMP91</DataSourceReference>
      <rd:SecurityType>DataBase</rd:SecurityType>
      <rd:DataSourceID>90f5b1c5-9c93-42e5-b298-755d0dfc2fcb</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="工廠下拉">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>select distinct Plant from PlantInfo</CommandText>
      </Query>
      <Fields>
        <Field Name="Plant">
          <DataField>Plant</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="樓棟">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@廠區">
            <Value>=Parameters!廠區.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>select distinct Building from PlantInfo
where Plant = @廠區</CommandText>
      </Query>
      <Fields>
        <Field Name="Building">
          <DataField>Building</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="機房">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@廠區">
            <Value>=Parameters!廠區.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@樓棟">
            <Value>=Parameters!樓棟.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>select distinct ComputerRoom from PlantInfo
where Plant = @廠區
and Building = @樓棟</CommandText>
      </Query>
      <Fields>
        <Field Name="ComputerRoom">
          <DataField>ComputerRoom</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="機櫃下拉">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>
select 'ALL' 機櫃名稱 union
(select distinct SUBSTRING(SensorName,1,4) as 機櫃名稱 from SensorInfo
where SensorName like '%電力')</CommandText>
      </Query>
      <Fields>
        <Field Name="機櫃名稱">
          <DataField>機櫃名稱</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="預設值">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <CommandText>select DATEPART(MONTH,GETDATE()) as 月份預設</CommandText>
      </Query>
      <Fields>
        <Field Name="月份預設">
          <DataField>月份預設</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="上下班電能匯總">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@年份">
            <Value>=Parameters!年份.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@月份">
            <Value>=Parameters!月份.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@機櫃">
            <Value>=Parameters!機櫃.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@廠區">
            <Value>=Parameters!廠區.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@樓棟">
            <Value>=Parameters!樓棟.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@機房">
            <Value>=Parameters!機房.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>begin
--author:'luojun'
--createdate:2017-8-3 08:45:27
--description:For updating The reporter,it's hard to motify the Sql code,So I decide to create a new one
--EndTime:2017-8-4 11:03:17
--endtime:2017-8-4 15:49:37

if exists(select *from tempdb.dbo.sysobjects  where id = object_id(N'tempdb..#TB1'))
drop table #TB1
--Base Data
create table #TB1 --Create TempTable for big Data
(
CreatDate datetime
,_Date nvarchar(10)
,Value float
,SensorName nvarchar(20)
,WorkDay nvarchar(10)
,WorkTime nvarchar(10)
)

--OneDayminValue,It's should Group by the Date and SensorName
declare @OneDayMinValue table --declare tableVariable for little data
(

_Date nvarchar(10)
,SensorName nvarchar(20)
,minValue float
)

--To get the oneday all energy
declare @OneDayDiffValue table
(
_Date nvarchar(10)
,SensorName nvarchar(20)
,OneDayDiffValue float
,WorkDay nvarchar(10)
)

--To get The work time energy
declare @WorkTimeValue table
(
_Date nvarchar(10)
,SensorName nvarchar(10)
,OnWorkTimeValue float
)

declare @WorkDayForTable table
(
OnWorkDayCount int
,OffWorkDayCount int,
OffWorkDay float
,OnWorkDay float
)

-----------------在工作日中包括上下班的電能,與一天的總電能(詳細)
declare @OnOffWorkTimeValue table
(
_Date nvarchar(10)
,SensorName nvarchar(10)
,OnWorkTimeValue float
,OffWorkTimeValue float
,OneDayDiffValue float
)
---------------用於上下班匯總時使用
declare @OnOffWorkTimeValueGather table
(
OnWorkTimeValueGather float
,OffWorkTimeValueGather float
,DayCount int
)


--set the start and end time
declare @StartDate datetime = CONVERT (nvarchar(4),@年份) +'-'+ @月份 + '-01'
declare @EndDate datetime =Dateadd(DAY,1,DATEADD(MONTH,1,@StartDate))--when Calculate the last day of a month ,it's need the next month first day's min Value
--select @EndDate
--------------------------------用於計算工作日與非工作日天數
declare @OnWorkDayCount int
declare @OffWorkDayCount int
declare @OnWorktimeCount int
declare @OffWorkTimeCount int
---------------------------------所有有數據的基本表
--The all Base Data
insert  #TB1
select A.CreateDate 
,CONVERT(nchar(10),CreateDate,120) as 日期
, CONVERT(float,A.Value) as 值
, B.SensorName as 機櫃名稱
,Case 
when (datename(dw,A.CreateDate) = '星期六' or datename(dw,A.CreateDate) = '星期日') then '非工作日'
else  '工作日'
end as WorkDay
,case when DATEPART(HOUR,A.CreateDate)&gt;=8 and (SUBSTRING (CONVERT(nchar(16),CreateDate,120),12,5)&lt;='17:30') then '上班'
else '下班'
end as WorkTime
from MonitData as A,SensorInfo as B,AddressInfo as C,ControlInfo as D
where A.DataID = C.ID
and C.SensorID = B.ID
and C.ControlID = D.ID
and (SUBSTRING(B.SensorName,1,4) = @機櫃 and C.Type = '有功電能' or (@機櫃 = 'ALL' and C.Type = '有功電能' and B.SensorName  like '%電力'  ))
--and DATEPART(MM,A.CreateDate) = @月份 
and A.CreateDate &gt; @StartDate --添加年份查詢,修改時間:2017-7-17 16:21:51 
and A.CreateDate&lt;@EndDate 
and D.Factory = @廠區
and D.Building = @樓棟
and D.ComputerRoom = @機房 
--and ISNUMERIC(A.Value)&gt;0
-------------------------------每一天中電能的最小值
insert @OneDayMinValue
select A._Date,A.SensorName,Min(A.Value) as minValue from #TB1 as A
group by _Date,SensorName

-------------------------------一天的電能值
insert @OneDayDiffValue
select A._Date,A.SensorName,B.minValue-A.minValue as OneDayDiffValue 
,Case when (datename(dw,A._Date) = '星期六' or datename(dw,A._Date) = '星期日') then '非工作日'
else  '工作日'
end as WorkDay
from @OneDayMinValue as A,@OneDayMinValue as B
where A.SensorName = B.SensorName
and A._Date = DATEADD(DAY,-1,B._Date)

-------------------------------上班時間的電能值
--To Calc the WorkTime electicity using,use the max Value of Worktime reduce the min Value of The worktime
insert @WorkTimeValue
select A._Date,A.SensorName,MAX(A.Value)-MIN(A.Value) as OnWorkTimeValue from #TB1 as A
where A.WorkDay = '工作日'
and A.WorkTime = '上班'
group by A._Date,A.SensorName

---------------------------上下班時間的電能值
--可用於上下班表格詳細
insert @OnOffWorkTimeValue
select A._Date,CONVERT(nvarchar(4),A.SensorName) as SensorName,A.OnWorkTimeValue,B.OneDayDiffValue - A.OnWorkTimeValue as OffWorkTimeValue,B.OneDayDiffValue 
from @WorkTimeValue as A,@OneDayDiffValue as B
where A._Date = B._Date 
and A.SensorName = B.SensorName 

------------------------上下班匯總
insert @OnOffWorkTimeValueGather
select SUM(B.OnWorkTimeValue) asOnWorkTimeValue,SUM(B.OffWorkTimeValue) as OffWorkTimeValue,COUNT(*)  from
(
select _Date,SUM(OnWorkTimeValue) as OnWorkTimeValue,SUM(OffWorkTimeValue)as OffWorkTimeValue,1 as gp from @OnOffWorkTimeValue as A
group by _Date)as B
group by B.gp


--------------------------------------工作日與非工作日計算
insert @WorkDayForTable(OnWorkDay) 
select SUM(OneDayDiffValue) as AllValue
--,DATEDIFF(DAY,MIN(_Date),Max(_Date))+1
from @OneDayDiffValue
group by WorkDay
having WorkDay = '工作日'

update @WorkDayForTable set OffWorkDay =  
(select SUM(OneDayDiffValue) as AllValue
from @OneDayDiffValue as A
group by WorkDay
having WorkDay = '非工作日')

select @OnWorkDayCount =COUNT(*) from
(select _Date from @OneDayDiffValue
where WorkDay = '工作日'
group by _Date) as A

select @OffWorkDayCount =  COUNT(*) from
(select _Date from @OneDayDiffValue
where WorkDay = '非工作日'
group by _Date) as A

update @WorkDayForTable set OnWorkDayCount = @OnWorkDayCount,OffWorkDayCount = @OffWorkDayCount

update @WorkDayForTable set OffWorkDay = 0 
where OffWorkDay is null
update @WorkDayForTable set OnWorkDay = 0
where OnWorkDay is null

end



--======================================================= 以下為匯總結果
-----------------------------------------表格:上下班電能匯總
select * from @OnOffWorkTimeValueGather

-----------------------------------------表格:上下班電能詳細
--select *from @OnOffWorkTimeValue

-----------------------------------------圖形:所有機櫃的圖形
--select *,CONVERT(nvarchar(4),SensorName) as SensorName1 from @OneDayDiffValue

----------------------------------------工作日與非工作日表格呈現
--select * from @WorkDayForTable

--Free the Temp Table
if exists(select *from tempdb.dbo.sysobjects  where id = object_id(N'tempdb..#TB1'))
drop table #TB1
</CommandText>
      </Query>
      <Fields>
        <Field Name="OnWorkTimeValueGather">
          <DataField>OnWorkTimeValueGather</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="OffWorkTimeValueGather">
          <DataField>OffWorkTimeValueGather</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="DayCount">
          <DataField>DayCount</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="上下班電能詳情">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@年份">
            <Value>=Parameters!年份.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@月份">
            <Value>=Parameters!月份.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@機櫃">
            <Value>=Parameters!機櫃.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@廠區">
            <Value>=Parameters!廠區.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@樓棟">
            <Value>=Parameters!樓棟.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@機房">
            <Value>=Parameters!機房.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>
begin
--author:'luojun'
--createdate:2017-8-3 08:45:27
--description:For updating The reporter,it's hard to motify the Sql code,So I decide to create a new one
--EndTime:2017-8-4 11:03:17
--endtime:2017-8-4 15:49:37

if exists(select *from tempdb.dbo.sysobjects  where id = object_id(N'tempdb..#TB1'))
drop table #TB1
--Base Data
create table #TB1 --Create TempTable for big Data
(
CreatDate datetime
,_Date nvarchar(10)
,Value float
,SensorName nvarchar(20)
,WorkDay nvarchar(10)
,WorkTime nvarchar(10)
)

--OneDayminValue,It's should Group by the Date and SensorName
declare @OneDayMinValue table --declare tableVariable for little data
(

_Date nvarchar(10)
,SensorName nvarchar(20)
,minValue float
)

--To get the oneday all energy
declare @OneDayDiffValue table
(
_Date nvarchar(10)
,SensorName nvarchar(20)
,OneDayDiffValue float
,WorkDay nvarchar(10)
)

--To get The work time energy
declare @WorkTimeValue table
(
_Date nvarchar(10)
,SensorName nvarchar(10)
,OnWorkTimeValue float
)

declare @WorkDayForTable table
(
OnWorkDayCount int
,OffWorkDayCount int,
OffWorkDay float
,OnWorkDay float
)

-----------------在工作日中包括上下班的電能,與一天的總電能(詳細)
declare @OnOffWorkTimeValue table
(
_Date nvarchar(10)
,SensorName nvarchar(10)
,OnWorkTimeValue float
,OffWorkTimeValue float
,OneDayDiffValue float
)
---------------用於上下班匯總時使用
declare @OnOffWorkTimeValueGather table
(
OnWorkTimeValueGather float
,OffWorkTimeValueGather float
,DayCount int
)


--set the start and end time
declare @StartDate datetime = CONVERT (nvarchar(4),@年份) +'-'+ @月份 + '-01'
declare @EndDate datetime =Dateadd(DAY,1,DATEADD(MONTH,1,@StartDate))--when Calculate the last day of a month ,it's need the next month first day's min Value
--select @EndDate
--------------------------------用於計算工作日與非工作日天數
declare @OnWorkDayCount int
declare @OffWorkDayCount int
declare @OnWorktimeCount int
declare @OffWorkTimeCount int
---------------------------------所有有數據的基本表
--The all Base Data
insert  #TB1
select A.CreateDate 
,CONVERT(nchar(10),CreateDate,120) as 日期
, CONVERT(float,A.Value) as 值
, B.SensorName as 機櫃名稱
,Case 
when (datename(dw,A.CreateDate) = '星期六' or datename(dw,A.CreateDate) = '星期日') then '非工作日'
else  '工作日'
end as WorkDay
,case when DATEPART(HOUR,A.CreateDate)&gt;=8 and (SUBSTRING (CONVERT(nchar(16),CreateDate,120),12,5)&lt;='17:30') then '上班'
else '下班'
end as WorkTime
from MonitData as A,SensorInfo as B,AddressInfo as C,ControlInfo as D
where A.DataID = C.ID
and C.SensorID = B.ID
and C.ControlID = D.ID
and (SUBSTRING(B.SensorName,1,4) = @機櫃 and C.Type = '有功電能' or (@機櫃 = 'ALL' and C.Type = '有功電能' and B.SensorName  like '%電力'  ))
--and DATEPART(MM,A.CreateDate) = @月份 
and A.CreateDate &gt; @StartDate --添加年份查詢,修改時間:2017-7-17 16:21:51 
and A.CreateDate&lt;@EndDate 
and D.Factory = @廠區
and D.Building = @樓棟
and D.ComputerRoom = @機房 
--and ISNUMERIC(A.Value)&gt;0
-------------------------------每一天中電能的最小值
insert @OneDayMinValue
select A._Date,A.SensorName,Min(A.Value) as minValue from #TB1 as A
group by _Date,SensorName

-------------------------------一天的電能值
insert @OneDayDiffValue
select A._Date,A.SensorName,B.minValue-A.minValue as OneDayDiffValue 
,Case when (datename(dw,A._Date) = '星期六' or datename(dw,A._Date) = '星期日') then '非工作日'
else  '工作日'
end as WorkDay
from @OneDayMinValue as A,@OneDayMinValue as B
where A.SensorName = B.SensorName
and A._Date = DATEADD(DAY,-1,B._Date)

-------------------------------上班時間的電能值
--To Calc the WorkTime electicity using,use the max Value of Worktime reduce the min Value of The worktime
insert @WorkTimeValue
select A._Date,A.SensorName,MAX(A.Value)-MIN(A.Value) as OnWorkTimeValue from #TB1 as A
where
 --A.WorkDay = '工作日'--------------- 2017-8-7 14:33:26,將此處注釋掉是為了查出所有日期的上下班詳細,包括非工作日
 A.WorkTime = '上班'
group by A._Date,A.SensorName

---------------------------上下班時間的電能值
--可用於上下班表格詳細
insert @OnOffWorkTimeValue
select A._Date,CONVERT(nvarchar(4),A.SensorName) as SensorName

---------------------------添加Case用于数据测试,2018-1-12 14:46:16,luojun
--,A.OnWorkTimeValue---正常使用时可恢复
,case when A.OnWorkTimeValue &gt;100 then 15
else A.OnWorkTimeValue
end as OnWorkTimeValue
-----------------------------------------

,B.OneDayDiffValue - A.OnWorkTimeValue as OffWorkTimeValue
,B.OneDayDiffValue 
from @WorkTimeValue as A,@OneDayDiffValue as B
where A._Date = B._Date 
and A.SensorName = B.SensorName 

------------------------上下班匯總
insert @OnOffWorkTimeValueGather
select SUM(B.OnWorkTimeValue) asOnWorkTimeValue,SUM(B.OffWorkTimeValue) as OffWorkTimeValue,COUNT(*)  from
(
select _Date,SUM(OnWorkTimeValue) as OnWorkTimeValue,SUM(OffWorkTimeValue)as OffWorkTimeValue,1 as gp from @OnOffWorkTimeValue as A
group by _Date)as B
group by B.gp


--------------------------------------工作日與非工作日計算
insert @WorkDayForTable(OnWorkDay) 
select SUM(OneDayDiffValue) as AllValue
--,DATEDIFF(DAY,MIN(_Date),Max(_Date))+1
from @OneDayDiffValue
group by WorkDay
having WorkDay = '工作日'

update @WorkDayForTable set OffWorkDay =  
(select SUM(OneDayDiffValue) as AllValue
from @OneDayDiffValue as A
group by WorkDay
having WorkDay = '非工作日')

select @OnWorkDayCount =COUNT(*) from
(select _Date from @OneDayDiffValue
where WorkDay = '工作日'
group by _Date) as A

select @OffWorkDayCount =  COUNT(*) from
(select _Date from @OneDayDiffValue
where WorkDay = '非工作日'
group by _Date) as A

update @WorkDayForTable set OnWorkDayCount = @OnWorkDayCount,OffWorkDayCount = @OffWorkDayCount

update @WorkDayForTable set OffWorkDay = 0 
where OffWorkDay is null
update @WorkDayForTable set OnWorkDay = 0
where OnWorkDay is null

end



--======================================================= 以下為匯總結果
-----------------------------------------表格:上下班電能匯總
--select * from @OnOffWorkTimeValueGather

-----------------------------------------表格:上下班電能詳細
select *from @OnOffWorkTimeValue

--select *from @OneDayDiffValue

-----------------------------------------圖形:所有機櫃的圖形
--select *,CONVERT(nvarchar(4),SensorName) as SensorName1 from @OneDayDiffValue

------------------------------------------工作日與非工作日表格呈現
--select * from @WorkDayForTable

--Free the Temp Table
if exists(select *from tempdb.dbo.sysobjects  where id = object_id(N'tempdb..#TB1'))
drop table #TB1



</CommandText>
      </Query>
      <Fields>
        <Field Name="ID_Date">
          <DataField>_Date</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="SensorName">
          <DataField>SensorName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="OnWorkTimeValue">
          <DataField>OnWorkTimeValue</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="OffWorkTimeValue">
          <DataField>OffWorkTimeValue</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="OneDayDiffValue">
          <DataField>OneDayDiffValue</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="所有的機櫃圖形">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@年份">
            <Value>=Parameters!年份.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@月份">
            <Value>=Parameters!月份.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@機櫃">
            <Value>=Parameters!機櫃.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@廠區">
            <Value>=Parameters!廠區.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@樓棟">
            <Value>=Parameters!樓棟.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@機房">
            <Value>=Parameters!機房.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>
begin
--author:'luojun'
--createdate:2017-8-3 08:45:27
--description:For updating The reporter,it's hard to motify the Sql code,So I decide to create a new one
--EndTime:2017-8-4 11:03:17
--endtime:2017-8-4 15:49:37

if exists(select *from tempdb.dbo.sysobjects  where id = object_id(N'tempdb..#TB1'))
drop table #TB1
--Base Data
create table #TB1 --Create TempTable for big Data
(
CreatDate datetime
,_Date nvarchar(10)
,Value float
,SensorName nvarchar(20)
,WorkDay nvarchar(10)
,WorkTime nvarchar(10)
)

--OneDayminValue,It's should Group by the Date and SensorName
declare @OneDayMinValue table --declare tableVariable for little data
(

_Date nvarchar(10)
,SensorName nvarchar(20)
,minValue float
)

--To get the oneday all energy
declare @OneDayDiffValue table
(
_Date nvarchar(10)
,SensorName nvarchar(20)
,OneDayDiffValue float
,WorkDay nvarchar(10)
)

--To get The work time energy
declare @WorkTimeValue table
(
_Date nvarchar(10)
,SensorName nvarchar(10)
,OnWorkTimeValue float
)

declare @WorkDayForTable table
(
OnWorkDayCount int
,OffWorkDayCount int,
OffWorkDay float
,OnWorkDay float
)

-----------------在工作日中包括上下班的電能,與一天的總電能(詳細)
declare @OnOffWorkTimeValue table
(
_Date nvarchar(10)
,SensorName nvarchar(10)
,OnWorkTimeValue float
,OffWorkTimeValue float
,OneDayDiffValue float
)
---------------用於上下班匯總時使用
declare @OnOffWorkTimeValueGather table
(
OnWorkTimeValueGather float
,OffWorkTimeValueGather float
,DayCount int
)


--set the start and end time
declare @StartDate datetime = CONVERT (nvarchar(4),@年份) +'-'+ @月份 + '-01'
declare @EndDate datetime =Dateadd(DAY,1,DATEADD(MONTH,1,@StartDate))--when Calculate the last day of a month ,it's need the next month first day's min Value
--select @EndDate
--------------------------------用於計算工作日與非工作日天數
declare @OnWorkDayCount int
declare @OffWorkDayCount int
declare @OnWorktimeCount int
declare @OffWorkTimeCount int
---------------------------------所有有數據的基本表
--The all Base Data
insert  #TB1
select A.CreateDate 
,CONVERT(nchar(10),CreateDate,120) as 日期
, CONVERT(float,A.Value) as 值
, B.SensorName as 機櫃名稱
,Case 
when (datename(dw,A.CreateDate) = '星期六' or datename(dw,A.CreateDate) = '星期日') then '非工作日'
else  '工作日'
end as WorkDay
,case when DATEPART(HOUR,A.CreateDate)&gt;=8 and (SUBSTRING (CONVERT(nchar(16),CreateDate,120),12,5)&lt;='17:30') then '上班'
else '下班'
end as WorkTime
from MonitData as A,SensorInfo as B,AddressInfo as C,ControlInfo as D
where A.DataID = C.ID
and C.SensorID = B.ID
and C.ControlID = D.ID
and (SUBSTRING(B.SensorName,1,4) = @機櫃 and C.Type = '有功電能' or (@機櫃 = 'ALL' and C.Type = '有功電能' and B.SensorName  like '%電力'  ))
--and DATEPART(MM,A.CreateDate) = @月份 
and A.CreateDate &gt; @StartDate --添加年份查詢,修改時間:2017-7-17 16:21:51 
and A.CreateDate&lt;@EndDate 
and D.Factory = @廠區
and D.Building = @樓棟
and D.ComputerRoom = @機房 
--and ISNUMERIC(A.Value)&gt;0
-------------------------------每一天中電能的最小值
insert @OneDayMinValue
select A._Date,A.SensorName,Min(A.Value) as minValue from #TB1 as A
group by _Date,SensorName

-------------------------------一天的電能值
insert @OneDayDiffValue
select A._Date,A.SensorName

----------------------------------------------数据测试附件条件,正常使用需恢复2018-1-12 15:00:02,luojun
--,B.minValue-A.minValue as OneDayDiffValue --正常使用不注释
,case when B.minValue-A.minValue&gt;100 then 40
else B.minValue-A.minValue
end as OneDayDiffValue
----------------------------------------------------------

,Case when (datename(dw,A._Date) = '星期六' or datename(dw,A._Date) = '星期日') then '非工作日'
else  '工作日'
end as WorkDay
from @OneDayMinValue as A,@OneDayMinValue as B
where A.SensorName = B.SensorName
and A._Date = DATEADD(DAY,-1,B._Date)

-------------------------------上班時間的電能值
--To Calc the WorkTime electicity using,use the max Value of Worktime reduce the min Value of The worktime
insert @WorkTimeValue
select A._Date,A.SensorName,MAX(A.Value)-MIN(A.Value) as OnWorkTimeValue from #TB1 as A
where A.WorkDay = '工作日'
and A.WorkTime = '上班'
group by A._Date,A.SensorName

---------------------------上下班時間的電能值
--可用於上下班表格詳細
insert @OnOffWorkTimeValue
select A._Date,CONVERT(nvarchar(4),A.SensorName) as SensorName,A.OnWorkTimeValue,B.OneDayDiffValue - A.OnWorkTimeValue as OffWorkTimeValue,B.OneDayDiffValue 
from @WorkTimeValue as A,@OneDayDiffValue as B
where A._Date = B._Date 
and A.SensorName = B.SensorName 

------------------------上下班匯總
insert @OnOffWorkTimeValueGather
select SUM(B.OnWorkTimeValue) asOnWorkTimeValue,SUM(B.OffWorkTimeValue) as OffWorkTimeValue,COUNT(*)  from
(
select _Date,SUM(OnWorkTimeValue) as OnWorkTimeValue,SUM(OffWorkTimeValue)as OffWorkTimeValue,1 as gp from @OnOffWorkTimeValue as A
group by _Date)as B
group by B.gp


--------------------------------------工作日與非工作日計算
insert @WorkDayForTable(OnWorkDay) 
select SUM(OneDayDiffValue) as AllValue
--,DATEDIFF(DAY,MIN(_Date),Max(_Date))+1
from @OneDayDiffValue
group by WorkDay
having WorkDay = '工作日'

update @WorkDayForTable set OffWorkDay =  
(select SUM(OneDayDiffValue) as AllValue
from @OneDayDiffValue as A
group by WorkDay
having WorkDay = '非工作日')

select @OnWorkDayCount =COUNT(*) from
(select _Date from @OneDayDiffValue
where WorkDay = '工作日'
group by _Date) as A

select @OffWorkDayCount =  COUNT(*) from
(select _Date from @OneDayDiffValue
where WorkDay = '非工作日'
group by _Date) as A

update @WorkDayForTable set OnWorkDayCount = @OnWorkDayCount,OffWorkDayCount = @OffWorkDayCount

update @WorkDayForTable set OffWorkDay = 0 
where OffWorkDay is null
update @WorkDayForTable set OnWorkDay = 0
where OnWorkDay is null

end



--======================================================= 以下為匯總結果
-----------------------------------------表格:上下班電能匯總
--select * from @OnOffWorkTimeValueGather

-----------------------------------------表格:上下班電能詳細
--select *from @OnOffWorkTimeValue

-----------------------------------------圖形:所有機櫃的圖形
select *,CONVERT(nvarchar(4),SensorName) as SensorName1 from @OneDayDiffValue

----------------------------------------工作日與非工作日表格呈現
--select * from @WorkDayForTable

--Free the Temp Table
if exists(select *from tempdb.dbo.sysobjects  where id = object_id(N'tempdb..#TB1'))
drop table #TB1</CommandText>
      </Query>
      <Fields>
        <Field Name="ID_Date">
          <DataField>_Date</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="SensorName">
          <DataField>SensorName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="OneDayDiffValue">
          <DataField>OneDayDiffValue</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="WorkDay">
          <DataField>WorkDay</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="SensorName1">
          <DataField>SensorName1</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="工作日與非工作日表格">
      <Query>
        <DataSourceName>DataSource1</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@年份">
            <Value>=Parameters!年份.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@月份">
            <Value>=Parameters!月份.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@機櫃">
            <Value>=Parameters!機櫃.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@廠區">
            <Value>=Parameters!廠區.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@樓棟">
            <Value>=Parameters!樓棟.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@機房">
            <Value>=Parameters!機房.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>
begin
--author:'luojun'
--createdate:2017-8-3 08:45:27
--description:For updating The reporter,it's hard to motify the Sql code,So I decide to create a new one
--EndTime:2017-8-4 11:03:17
--endtime:2017-8-4 15:49:37

if exists(select *from tempdb.dbo.sysobjects  where id = object_id(N'tempdb..#TB1'))
drop table #TB1
--Base Data
create table #TB1 --Create TempTable for big Data
(
CreatDate datetime
,_Date nvarchar(10)
,Value float
,SensorName nvarchar(20)
,WorkDay nvarchar(10)
,WorkTime nvarchar(10)
)

--OneDayminValue,It's should Group by the Date and SensorName
declare @OneDayMinValue table --declare tableVariable for little data
(

_Date nvarchar(10)
,SensorName nvarchar(20)
,minValue float
)

--To get the oneday all energy
declare @OneDayDiffValue table
(
_Date nvarchar(10)
,SensorName nvarchar(20)
,OneDayDiffValue float
,WorkDay nvarchar(10)
)

--To get The work time energy
declare @WorkTimeValue table
(
_Date nvarchar(10)
,SensorName nvarchar(10)
,OnWorkTimeValue float
)

declare @WorkDayForTable table
(
OnWorkDayCount int
,OffWorkDayCount int,
OffWorkDay float
,OnWorkDay float
)

-----------------在工作日中包括上下班的電能,與一天的總電能(詳細)
declare @OnOffWorkTimeValue table
(
_Date nvarchar(10)
,SensorName nvarchar(10)
,OnWorkTimeValue float
,OffWorkTimeValue float
,OneDayDiffValue float
)
---------------用於上下班匯總時使用
declare @OnOffWorkTimeValueGather table
(
OnWorkTimeValueGather float
,OffWorkTimeValueGather float
,DayCount int
)


--set the start and end time
declare @StartDate datetime = CONVERT (nvarchar(4),@年份) +'-'+ @月份 + '-01'
declare @EndDate datetime =Dateadd(DAY,1,DATEADD(MONTH,1,@StartDate))--when Calculate the last day of a month ,it's need the next month first day's min Value
--select @EndDate
--------------------------------用於計算工作日與非工作日天數
declare @OnWorkDayCount int
declare @OffWorkDayCount int
declare @OnWorktimeCount int
declare @OffWorkTimeCount int
---------------------------------所有有數據的基本表
--The all Base Data
insert  #TB1
select A.CreateDate 
,CONVERT(nchar(10),CreateDate,120) as 日期
, CONVERT(float,A.Value) as 值
, B.SensorName as 機櫃名稱
,Case 
when (datename(dw,A.CreateDate) = '星期六' or datename(dw,A.CreateDate) = '星期日') then '非工作日'
else  '工作日'
end as WorkDay
,case when DATEPART(HOUR,A.CreateDate)&gt;=8 and (SUBSTRING (CONVERT(nchar(16),CreateDate,120),12,5)&lt;='17:30') then '上班'
else '下班'
end as WorkTime
from MonitData as A,SensorInfo as B,AddressInfo as C,ControlInfo as D
where A.DataID = C.ID
and C.SensorID = B.ID
and C.ControlID = D.ID
and (SUBSTRING(B.SensorName,1,4) = @機櫃 and C.Type = '有功電能' or (@機櫃 = 'ALL' and C.Type = '有功電能' and B.SensorName  like '%電力'  ))
--and DATEPART(MM,A.CreateDate) = @月份 
and A.CreateDate &gt; @StartDate --添加年份查詢,修改時間:2017-7-17 16:21:51 
and A.CreateDate&lt;@EndDate 
and D.Factory = @廠區
and D.Building = @樓棟
and D.ComputerRoom = @機房 
--and ISNUMERIC(A.Value)&gt;0
-------------------------------每一天中電能的最小值
insert @OneDayMinValue
select A._Date,A.SensorName,Min(A.Value) as minValue from #TB1 as A
group by _Date,SensorName

-------------------------------一天的電能值
insert @OneDayDiffValue
select A._Date,A.SensorName,B.minValue-A.minValue as OneDayDiffValue 
,Case when (datename(dw,A._Date) = '星期六' or datename(dw,A._Date) = '星期日') then '非工作日'
else  '工作日'
end as WorkDay
from @OneDayMinValue as A,@OneDayMinValue as B
where A.SensorName = B.SensorName
and A._Date = DATEADD(DAY,-1,B._Date)

-------------------------------上班時間的電能值
--To Calc the WorkTime electicity using,use the max Value of Worktime reduce the min Value of The worktime
insert @WorkTimeValue
select A._Date,A.SensorName,MAX(A.Value)-MIN(A.Value) as OnWorkTimeValue from #TB1 as A
where A.WorkDay = '工作日'
and A.WorkTime = '上班'
group by A._Date,A.SensorName

---------------------------上下班時間的電能值
--可用於上下班表格詳細
insert @OnOffWorkTimeValue
select A._Date,CONVERT(nvarchar(4),A.SensorName) as SensorName,A.OnWorkTimeValue,B.OneDayDiffValue - A.OnWorkTimeValue as OffWorkTimeValue,B.OneDayDiffValue 
from @WorkTimeValue as A,@OneDayDiffValue as B
where A._Date = B._Date 
and A.SensorName = B.SensorName 

------------------------上下班匯總
insert @OnOffWorkTimeValueGather
select SUM(B.OnWorkTimeValue) asOnWorkTimeValue,SUM(B.OffWorkTimeValue) as OffWorkTimeValue,COUNT(*)  from
(
select _Date,SUM(OnWorkTimeValue) as OnWorkTimeValue,SUM(OffWorkTimeValue)as OffWorkTimeValue,1 as gp from @OnOffWorkTimeValue as A
group by _Date)as B
group by B.gp


--------------------------------------工作日與非工作日計算
insert @WorkDayForTable(OnWorkDay) 
select SUM(OneDayDiffValue) as AllValue
--,DATEDIFF(DAY,MIN(_Date),Max(_Date))+1
from @OneDayDiffValue
group by WorkDay
having WorkDay = '工作日'

update @WorkDayForTable set OffWorkDay =  
(select SUM(OneDayDiffValue) as AllValue
from @OneDayDiffValue as A
group by WorkDay
having WorkDay = '非工作日')

select @OnWorkDayCount =COUNT(*) from
(select _Date from @OneDayDiffValue
where WorkDay = '工作日'
group by _Date) as A

select @OffWorkDayCount =  COUNT(*) from
(select _Date from @OneDayDiffValue
where WorkDay = '非工作日'
group by _Date) as A

update @WorkDayForTable set OnWorkDayCount = @OnWorkDayCount,OffWorkDayCount = @OffWorkDayCount

update @WorkDayForTable set OffWorkDay = 0 
where OffWorkDay is null
update @WorkDayForTable set OnWorkDay = 0
where OnWorkDay is null

end



--======================================================= 以下為匯總結果
-----------------------------------------表格:上下班電能匯總
--select * from @OnOffWorkTimeValueGather

-----------------------------------------表格:上下班電能詳細
--select *from @OnOffWorkTimeValue

-----------------------------------------圖形:所有機櫃的圖形
--select *,CONVERT(nvarchar(4),SensorName) as SensorName1 from @OneDayDiffValue

----------------------------------------工作日與非工作日表格呈現
select * from @WorkDayForTable

--Free the Temp Table
if exists(select *from tempdb.dbo.sysobjects  where id = object_id(N'tempdb..#TB1'))
drop table #TB1
</CommandText>
      </Query>
      <Fields>
        <Field Name="OnWorkDayCount">
          <DataField>OnWorkDayCount</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="OffWorkDayCount">
          <DataField>OffWorkDayCount</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="OffWorkDay">
          <DataField>OffWorkDay</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
        <Field Name="OnWorkDay">
          <DataField>OnWorkDay</DataField>
          <rd:TypeName>System.Double</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix3">
            <TablixCorner>
              <TablixCornerRows>
                <TablixCornerRow>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox41">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value />
                                <Style />
                              </TextRun>
                            </TextRuns>
                            <Style />
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox41</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>LightGrey</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#7292cc</BackgroundColor>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixCornerCell>
                </TablixCornerRow>
                <TablixCornerRow>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox42">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>類型</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox42</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#7292cc</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#4c68a2</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixCornerCell>
                </TablixCornerRow>
              </TablixCornerRows>
            </TablixCorner>
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>29.7243mm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>30.07847mm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>6.35mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox9">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>9.5</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox9</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#9eb6e4</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox10">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>14.5</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox10</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#9eb6e4</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>6mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OnWorkTimeValueGather">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!OnWorkTimeValueGather.Value)/
(Fields!DayCount.Value*9.5)</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>f2</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OnWorkTimeValueGather</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#9eb6e4</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OffWorkTimeValueGather">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!OffWorkTimeValueGather.Value)/
(Fields!DayCount.Value*14.5)</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>f2</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OffWorkTimeValueGather</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#9eb6e4</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>6mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OnWorkTimeValueGather1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!OnWorkTimeValueGather.Value)/
(Fields!DayCount.Value*9.5)
/(Sum(Fields!OnWorkTimeValueGather.Value)/
(Fields!DayCount.Value*9.5) + Sum(Fields!OffWorkTimeValueGather.Value)/
(Fields!DayCount.Value*14.5))</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>0.00%</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OnWorkTimeValueGather1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#9eb6e4</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OffWorkTimeValueGather1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!OffWorkTimeValueGather.Value)/
(Fields!DayCount.Value*14.5)
/(Sum(Fields!OnWorkTimeValueGather.Value)/
(Fields!DayCount.Value*9.5) + Sum(Fields!OffWorkTimeValueGather.Value)/
(Fields!DayCount.Value*14.5))</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>0.00%</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OffWorkTimeValueGather1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#9eb6e4</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember>
                  <TablixHeader>
                    <Size>6mm</Size>
                    <CellContents>
                      <Textbox Name="Textbox47">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>上下班用電量對比</Value>
                                <Style>
                                  <FontFamily>微軟正黑體</FontFamily>
                                  <FontSize>12pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox47</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#9eb6e4</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#7292cc</BackgroundColor>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <TablixMember>
                      <TablixHeader>
                        <Size>6mm</Size>
                        <CellContents>
                          <Textbox Name="Textbox48">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>上班</Value>
                                    <Style>
                                      <FontFamily>Tahoma</FontFamily>
                                      <FontSize>11pt</FontSize>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>White</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style>
                                  <TextAlign>Center</TextAlign>
                                </Style>
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox48</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>#7292cc</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>#4c68a2</BackgroundColor>
                              <VerticalAlign>Middle</VerticalAlign>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                      <TablixMembers>
                        <TablixMember />
                      </TablixMembers>
                    </TablixMember>
                    <TablixMember>
                      <TablixHeader>
                        <Size>6mm</Size>
                        <CellContents>
                          <Textbox Name="Textbox52">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>下班</Value>
                                    <Style>
                                      <FontFamily>Tahoma</FontFamily>
                                      <FontSize>11pt</FontSize>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>White</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style>
                                  <TextAlign>Center</TextAlign>
                                </Style>
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>Textbox52</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>#7292cc</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>#4c68a2</BackgroundColor>
                              <VerticalAlign>Middle</VerticalAlign>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                      <TablixMembers>
                        <TablixMember />
                      </TablixMembers>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <TablixHeader>
                    <Size>42.28417mm</Size>
                    <CellContents>
                      <Textbox Name="Textbox6">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>時間長度（小時）</Value>
                                <Style>
                                  <FontStyle>Normal</FontStyle>
                                  <FontFamily>微軟正黑體</FontFamily>
                                  <FontSize>12pt</FontSize>
                                  <FontWeight>Normal</FontWeight>
                                  <TextDecoration>None</TextDecoration>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox6</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#9eb6e4</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#7292cc</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                </TablixMember>
                <TablixMember>
                  <TablixHeader>
                    <Size>42.28417mm</Size>
                    <CellContents>
                      <Textbox Name="Textbox44">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>平均用電量</Value>
                                <Style>
                                  <FontStyle>Normal</FontStyle>
                                  <FontFamily>微軟正黑體</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Normal</FontWeight>
                                  <TextDecoration>None</TextDecoration>
                                </Style>
                              </TextRun>
                              <TextRun>
                                <Value>/kWh</Value>
                                <Style>
                                  <FontStyle>Normal</FontStyle>
                                  <FontFamily>微軟正黑體</FontFamily>
                                  <FontSize>12pt</FontSize>
                                  <FontWeight>Normal</FontWeight>
                                  <TextDecoration>None</TextDecoration>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox44</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#9eb6e4</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#7292cc</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                </TablixMember>
                <TablixMember>
                  <TablixHeader>
                    <Size>42.28417mm</Size>
                    <CellContents>
                      <Textbox Name="Textbox59">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>占比</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox59</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#9eb6e4</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#7292cc</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>上下班電能匯總</DataSetName>
            <Top>333.81828mm</Top>
            <Left>1.10475mm</Left>
            <Height>30.35mm</Height>
            <Width>102.08694mm</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
          <Tablix Name="Tablix1">
            <TablixCorner>
              <TablixCornerRows>
                <TablixCornerRow>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox7">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value />
                                <Style />
                              </TextRun>
                            </TextRuns>
                            <Style />
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox7</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>LightGrey</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#7292cc</BackgroundColor>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixCornerCell>
                </TablixCornerRow>
                <TablixCornerRow>
                  <TablixCornerCell>
                    <CellContents>
                      <Textbox Name="Textbox8">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>日期</Value>
                                <Style>
                                  <FontFamily>Tahoma</FontFamily>
                                  <FontSize>11pt</FontSize>
                                  <FontWeight>Bold</FontWeight>
                                  <Color>White</Color>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style>
                              <TextAlign>Center</TextAlign>
                            </Style>
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Textbox8</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>#7292cc</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>#4c68a2</BackgroundColor>
                          <VerticalAlign>Middle</VerticalAlign>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixCornerCell>
                </TablixCornerRow>
              </TablixCornerRows>
            </TablixCorner>
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>34.11597mm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>34.47014mm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>6mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OffWorkTimeValue">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!OffWorkTimeValue.Value)</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>f2</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OffWorkTimeValue</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OnWorkTimeValue">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!OnWorkTimeValue.Value)</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>f2</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OnWorkTimeValue</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="SensorName">
                    <GroupExpressions>
                      <GroupExpression>=Fields!SensorName.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!SensorName.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <TablixMembers>
                    <TablixMember>
                      <TablixHeader>
                        <Size>6mm</Size>
                        <CellContents>
                          <Textbox Name="SensorName">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>=Fields!SensorName.Value</Value>
                                    <Style>
                                      <FontFamily>Tahoma</FontFamily>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>#465678</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style>
                                  <TextAlign>Center</TextAlign>
                                </Style>
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>SensorName</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>#c6daf8</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>#9eb6e4</BackgroundColor>
                              <VerticalAlign>Middle</VerticalAlign>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                      <TablixMembers>
                        <TablixMember>
                          <TablixHeader>
                            <Size>6mm</Size>
                            <CellContents>
                              <Textbox Name="Textbox3">
                                <CanGrow>true</CanGrow>
                                <KeepTogether>true</KeepTogether>
                                <Paragraphs>
                                  <Paragraph>
                                    <TextRuns>
                                      <TextRun>
                                        <Value>下班總電能</Value>
                                        <Style>
                                          <FontFamily>Tahoma</FontFamily>
                                          <FontSize>11pt</FontSize>
                                          <FontWeight>Bold</FontWeight>
                                          <Color>White</Color>
                                        </Style>
                                      </TextRun>
                                    </TextRuns>
                                    <Style>
                                      <TextAlign>Center</TextAlign>
                                    </Style>
                                  </Paragraph>
                                </Paragraphs>
                                <rd:DefaultName>Textbox3</rd:DefaultName>
                                <Style>
                                  <Border>
                                    <Color>#7292cc</Color>
                                    <Style>Solid</Style>
                                  </Border>
                                  <BackgroundColor>#4c68a2</BackgroundColor>
                                  <VerticalAlign>Middle</VerticalAlign>
                                  <PaddingLeft>2pt</PaddingLeft>
                                  <PaddingRight>2pt</PaddingRight>
                                  <PaddingTop>2pt</PaddingTop>
                                  <PaddingBottom>2pt</PaddingBottom>
                                </Style>
                              </Textbox>
                            </CellContents>
                          </TablixHeader>
                          <TablixMembers>
                            <TablixMember />
                          </TablixMembers>
                        </TablixMember>
                        <TablixMember>
                          <TablixHeader>
                            <Size>6mm</Size>
                            <CellContents>
                              <Textbox Name="Textbox5">
                                <CanGrow>true</CanGrow>
                                <KeepTogether>true</KeepTogether>
                                <Paragraphs>
                                  <Paragraph>
                                    <TextRuns>
                                      <TextRun>
                                        <Value>上班總電能</Value>
                                        <Style>
                                          <FontFamily>Tahoma</FontFamily>
                                          <FontSize>11pt</FontSize>
                                          <FontWeight>Bold</FontWeight>
                                          <Color>White</Color>
                                        </Style>
                                      </TextRun>
                                    </TextRuns>
                                    <Style>
                                      <TextAlign>Center</TextAlign>
                                    </Style>
                                  </Paragraph>
                                </Paragraphs>
                                <rd:DefaultName>Textbox5</rd:DefaultName>
                                <Style>
                                  <Border>
                                    <Color>#7292cc</Color>
                                    <Style>Solid</Style>
                                  </Border>
                                  <BackgroundColor>#4c68a2</BackgroundColor>
                                  <VerticalAlign>Middle</VerticalAlign>
                                  <PaddingLeft>2pt</PaddingLeft>
                                  <PaddingRight>2pt</PaddingRight>
                                  <PaddingTop>2pt</PaddingTop>
                                  <PaddingBottom>2pt</PaddingBottom>
                                </Style>
                              </Textbox>
                            </CellContents>
                          </TablixHeader>
                        </TablixMember>
                      </TablixMembers>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="ID_Date">
                    <GroupExpressions>
                      <GroupExpression>=Fields!ID_Date.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!ID_Date.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <TablixMembers>
                    <TablixMember>
                      <TablixHeader>
                        <Size>43.06181mm</Size>
                        <CellContents>
                          <Textbox Name="ID_Date">
                            <CanGrow>true</CanGrow>
                            <KeepTogether>true</KeepTogether>
                            <Paragraphs>
                              <Paragraph>
                                <TextRuns>
                                  <TextRun>
                                    <Value>=Fields!ID_Date.Value</Value>
                                    <Style>
                                      <FontFamily>Tahoma</FontFamily>
                                      <FontWeight>Bold</FontWeight>
                                      <Color>#465678</Color>
                                    </Style>
                                  </TextRun>
                                </TextRuns>
                                <Style>
                                  <TextAlign>Center</TextAlign>
                                </Style>
                              </Paragraph>
                            </Paragraphs>
                            <rd:DefaultName>ID_Date</rd:DefaultName>
                            <Style>
                              <Border>
                                <Color>#c6daf8</Color>
                                <Style>Solid</Style>
                              </Border>
                              <BackgroundColor>#9eb6e4</BackgroundColor>
                              <VerticalAlign>Middle</VerticalAlign>
                              <PaddingLeft>2pt</PaddingLeft>
                              <PaddingRight>2pt</PaddingRight>
                              <PaddingTop>2pt</PaddingTop>
                              <PaddingBottom>2pt</PaddingBottom>
                            </Style>
                          </Textbox>
                        </CellContents>
                      </TablixHeader>
                      <TablixMembers>
                        <TablixMember />
                      </TablixMembers>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>上下班電能詳情</DataSetName>
            <Top>373.2412mm</Top>
            <Left>1.10475mm</Left>
            <Height>18mm</Height>
            <Width>111.64792mm</Width>
            <ZIndex>1</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
          <Tablix Name="Tablix6">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>33.73125mm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>29.10417mm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>31.48957mm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>6mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox129">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>工作日/非工作日用電量對比</Value>
                                  <Style>
                                    <FontStyle>Normal</FontStyle>
                                    <FontFamily>微軟正黑體</FontFamily>
                                    <FontSize>12pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox129</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>White</Color>
                              <Style>Solid</Style>
                            </Border>
                            <TopBorder>
                              <Color>White</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </TopBorder>
                            <BottomBorder>
                              <Color>White</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </BottomBorder>
                            <LeftBorder>
                              <Color>White</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </LeftBorder>
                            <RightBorder>
                              <Color>White</Color>
                              <Style>Solid</Style>
                              <Width>1pt</Width>
                            </RightBorder>
                            <BackgroundColor>#7292cc</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>6mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox46">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>類型</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox42</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#7292cc</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>#4c68a2</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox122">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>工作日用電量</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox122</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#7292cc</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>#4c68a2</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox123">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>非工作日用電量</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <FontSize>11pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox123</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#7292cc</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>#4c68a2</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>6.35mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox25">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>時間長度(天)</Value>
                                  <Style>
                                    <FontStyle>Normal</FontStyle>
                                    <FontFamily>微軟正黑體</FontFamily>
                                    <FontSize>12pt</FontSize>
                                    <FontWeight>Normal</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox25</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#9eb6e4</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>#7292cc</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OnWorkDayCount1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!OnWorkDayCount.Value)</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OnWorkDayCount1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OffWorkDayCount1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!OffWorkDayCount.Value)</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OffWorkDayCount1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>6mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox45">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>平均用電/kWh</Value>
                                  <Style>
                                    <FontStyle>Normal</FontStyle>
                                    <FontFamily>微軟正黑體</FontFamily>
                                    <FontSize>12pt</FontSize>
                                    <FontWeight>Normal</FontWeight>
                                    <TextDecoration>None</TextDecoration>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox44</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#9eb6e4</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>#7292cc</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OnWorkDay">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!OnWorkDay.Value)/Fields!OnWorkDayCount.Value</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>f2</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OnWorkDay</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OffWorkDay">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Sum(Fields!OffWorkDay.Value)/Fields!OffWorkDayCount.Value</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>f2</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OffWorkDay</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>6mm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox64">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>占比</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <FontWeight>Bold</FontWeight>
                                    <Color>White</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox59</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#9eb6e4</Color>
                              <Style>Solid</Style>
                            </Border>
                            <BackgroundColor>#7292cc</BackgroundColor>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OnWorkDayCount">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=(Sum(Fields!OnWorkDay.Value)/Fields!OnWorkDayCount.Value)
/(Sum(Fields!OnWorkDay.Value)/Fields!OnWorkDayCount.Value+Sum(Fields!OffWorkDay.Value)/Fields!OffWorkDayCount.Value)</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>0.00%</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OnWorkDayCount</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="OffWorkDayCount">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=(Sum(Fields!OffWorkDay.Value)/Fields!OffWorkDayCount.Value)
/(Sum(Fields!OnWorkDay.Value)/Fields!OnWorkDayCount.Value+Sum(Fields!OffWorkDay.Value)/Fields!OffWorkDayCount.Value)</Value>
                                  <Style>
                                    <FontFamily>Tahoma</FontFamily>
                                    <Format>0.00%</Format>
                                    <Color>#4d4d4d</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Center</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>OffWorkDayCount</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>#e5e5e5</Color>
                              <Style>Solid</Style>
                            </Border>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>工作日與非工作日表格</DataSetName>
            <Top>333.81828mm</Top>
            <Left>108.51934mm</Left>
            <Height>30.35mm</Height>
            <Width>94.32499mm</Width>
            <ZIndex>2</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
          <Textbox Name="Textbox19">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>單位：kWh</Value>
                    <Style>
                      <FontStyle>Normal</FontStyle>
                      <FontFamily>微軟正黑體</FontFamily>
                      <FontSize>12pt</FontSize>
                      <FontWeight>Normal</FontWeight>
                      <TextDecoration>None</TextDecoration>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <rd:DefaultName>Textbox19</rd:DefaultName>
            <Top>326.40717mm</Top>
            <Left>1.10475mm</Left>
            <Height>6mm</Height>
            <Width>23.54792mm</Width>
            <ZIndex>3</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
          <Chart Name="Chart13">
            <ChartCategoryHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Group Name="Chart13_CategoryGroup">
                    <GroupExpressions>
                      <GroupExpression>=Fields!ID_Date.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!ID_Date.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <Label>=Fields!ID_Date.Value</Label>
                </ChartMember>
              </ChartMembers>
            </ChartCategoryHierarchy>
            <ChartSeriesHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Group Name="Chart13_SeriesGroup">
                    <GroupExpressions>
                      <GroupExpression>=Fields!SensorName1.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!SensorName1.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <Label>=Fields!SensorName1.Value</Label>
                </ChartMember>
              </ChartMembers>
            </ChartSeriesHierarchy>
            <ChartData>
              <ChartSeriesCollection>
                <ChartSeries Name="OneDayDiffValue">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=Sum(Fields!OneDayDiffValue.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style />
                      </ChartDataLabel>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Line</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
              </ChartSeriesCollection>
            </ChartData>
            <ChartAreas>
              <ChartArea Name="Default">
                <ChartCategoryAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>日期</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <Interval>1</Interval>
                    <IntervalType>Days</IntervalType>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <Angle>-30</Angle>
                    <PreventLabelOffset>true</PreventLabelOffset>
                    <PreventWordWrap>true</PreventWordWrap>
                    <AllowLabelRotation>Rotate45</AllowLabelRotation>
                    <LabelsAutoFitDisabled>true</LabelsAutoFitDisabled>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartCategoryAxes>
                <ChartValueAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>電能/KWh</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartValueAxes>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <BackgroundHatchType>None</BackgroundHatchType>
                </Style>
              </ChartArea>
            </ChartAreas>
            <ChartLegends>
              <ChartLegend Name="Default">
                <Style>
                  <Border>
                    <Color>Maroon</Color>
                  </Border>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartLegendTitle>
                  <Caption />
                  <Style>
                    <FontSize>8pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </ChartLegendTitle>
                <HeaderSeparatorColor>Black</HeaderSeparatorColor>
                <ColumnSeparatorColor>Black</ColumnSeparatorColor>
              </ChartLegend>
            </ChartLegends>
            <ChartTitles>
              <ChartTitle Name="Default">
                <Caption>各機櫃用電量走勢</Caption>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontWeight>Bold</FontWeight>
                  <TextAlign>General</TextAlign>
                  <VerticalAlign>Top</VerticalAlign>
                </Style>
              </ChartTitle>
            </ChartTitles>
            <Palette>Pastel</Palette>
            <ChartBorderSkin>
              <Style>
                <BackgroundColor>Gray</BackgroundColor>
                <BackgroundGradientType>None</BackgroundGradientType>
                <Color>White</Color>
              </Style>
            </ChartBorderSkin>
            <ChartNoDataMessage Name="NoDataMessage">
              <Caption>沒有可用資料</Caption>
              <Style>
                <BackgroundGradientType>None</BackgroundGradientType>
                <TextAlign>General</TextAlign>
                <VerticalAlign>Top</VerticalAlign>
              </Style>
            </ChartNoDataMessage>
            <DataSetName>所有的機櫃圖形</DataSetName>
            <Left>0.11047cm</Left>
            <Height>13.93192cm</Height>
            <Width>31cm</Width>
            <ZIndex>4</ZIndex>
            <Visibility>
              <Hidden>=IIf(Parameters!機櫃.Value &lt;&gt; "ALL",True,False)</Hidden>
            </Visibility>
            <Style>
              <Border>
                <Color>LightGrey</Color>
                <Style>Solid</Style>
              </Border>
              <BackgroundColor>White</BackgroundColor>
              <BackgroundGradientType>None</BackgroundGradientType>
              <BackgroundHatchType>None</BackgroundHatchType>
            </Style>
          </Chart>
          <Chart Name="Chart7">
            <ChartCategoryHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Label />
                </ChartMember>
              </ChartMembers>
            </ChartCategoryHierarchy>
            <ChartSeriesHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Label>On Work Day</Label>
                </ChartMember>
                <ChartMember>
                  <Label>Off Work Day</Label>
                </ChartMember>
              </ChartMembers>
            </ChartSeriesHierarchy>
            <ChartData>
              <ChartSeriesCollection>
                <ChartSeries Name="工作日用電量">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=Sum(Fields!OnWorkDay.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style>
                          <Format>f2</Format>
                        </Style>
                        <Label>=

 "工作日"
+ Constants.vbcrlf
+CStr(Format((Sum(Fields!OnWorkDay.Value)/Fields!OnWorkDayCount.Value)
/(Sum(Fields!OnWorkDay.Value)/Fields!OnWorkDayCount.Value+Sum(Fields!OffWorkDay.Value)/Fields!OffWorkDayCount.Value), "0.00%"))</Label>
                        <Visible>true</Visible>
                      </ChartDataLabel>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                      <ChartItemInLegend>
                        <LegendText>工作日</LegendText>
                      </ChartItemInLegend>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Shape</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
                <ChartSeries Name="非工作日用電量">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=Sum(Fields!OffWorkDay.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style />
                        <Label>=

 "非工作日"
+ Constants.vbcrlf
+CStr(Format((Sum(Fields!OffWorkDay.Value)/Fields!OffWorkDayCount.Value)
/(Sum(Fields!OnWorkDay.Value)/Fields!OnWorkDayCount.Value+Sum(Fields!OffWorkDay.Value)/Fields!OffWorkDayCount.Value), "0.00%"))</Label>
                        <Visible>true</Visible>
                      </ChartDataLabel>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                      <ChartItemInLegend>
                        <LegendText>非工作日</LegendText>
                      </ChartItemInLegend>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Shape</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style>
                        <Format>f2</Format>
                      </Style>
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
              </ChartSeriesCollection>
            </ChartData>
            <ChartAreas>
              <ChartArea Name="Default">
                <ChartCategoryAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartCategoryAxes>
                <ChartValueAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartValueAxes>
                <ChartThreeDProperties>
                  <Enabled>true</Enabled>
                </ChartThreeDProperties>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                </Style>
              </ChartArea>
            </ChartAreas>
            <ChartLegends>
              <ChartLegend Name="Default">
                <Hidden>true</Hidden>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartLegendTitle>
                  <Caption />
                  <Style>
                    <FontSize>8pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </ChartLegendTitle>
                <HeaderSeparatorColor>Black</HeaderSeparatorColor>
                <ColumnSeparatorColor>Black</ColumnSeparatorColor>
              </ChartLegend>
            </ChartLegends>
            <ChartTitles>
              <ChartTitle Name="Default">
                <Caption>工作日/非工作日用电量对比</Caption>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontWeight>Bold</FontWeight>
                  <TextAlign>General</TextAlign>
                  <VerticalAlign>Top</VerticalAlign>
                </Style>
              </ChartTitle>
            </ChartTitles>
            <Palette>BrightPastel</Palette>
            <ChartBorderSkin>
              <Style>
                <BackgroundColor>Gray</BackgroundColor>
                <BackgroundGradientType>None</BackgroundGradientType>
                <Color>White</Color>
              </Style>
            </ChartBorderSkin>
            <ChartNoDataMessage Name="NoDataMessage">
              <Caption>沒有可用資料</Caption>
              <Style>
                <BackgroundGradientType>None</BackgroundGradientType>
                <TextAlign>General</TextAlign>
                <VerticalAlign>Top</VerticalAlign>
              </Style>
            </ChartNoDataMessage>
            <DataSetName>工作日與非工作日表格</DataSetName>
            <Top>14.00248cm</Top>
            <Left>10.81511cm</Left>
            <Height>8.04271cm</Height>
            <Width>11.89208cm</Width>
            <ZIndex>5</ZIndex>
            <Visibility>
              <Hidden>=IIf(Parameters!機櫃.Value &lt;&gt; "ALL",True,False)</Hidden>
            </Visibility>
            <Style>
              <Border>
                <Color>LightGrey</Color>
                <Style>Solid</Style>
              </Border>
              <BackgroundColor>White</BackgroundColor>
              <BackgroundGradientType>None</BackgroundGradientType>
            </Style>
          </Chart>
          <Chart Name="Chart3">
            <ChartCategoryHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Label />
                </ChartMember>
              </ChartMembers>
            </ChartCategoryHierarchy>
            <ChartSeriesHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Label>Off Work Time Value Gather</Label>
                </ChartMember>
                <ChartMember>
                  <Label>On Work Time Value Gather</Label>
                </ChartMember>
              </ChartMembers>
            </ChartSeriesHierarchy>
            <ChartData>
              <ChartSeriesCollection>
                <ChartSeries Name="下班總電能">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=Sum(Fields!OffWorkTimeValueGather.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style>
                          <Format>0.00%</Format>
                        </Style>
                        <Label>=
 "下班總電能"
+ Constants.vbcrlf 
+CStr(Format(Sum(Fields!OffWorkTimeValueGather.Value)
 / (Sum(Fields!OffWorkTimeValueGather.Value) + Sum(Fields!OnWorkTimeValueGather.Value)), "0.00%"))</Label>
                        <Visible>true</Visible>
                      </ChartDataLabel>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Shape</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
                <ChartSeries Name="上班總電能">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=Sum(Fields!OnWorkTimeValueGather.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style>
                          <Format>0.00%</Format>
                        </Style>
                        <Label>=
 "上班總電能"
+ Constants.vbcrlf 
+CStr(Format(Sum(Fields!OnWorkTimeValueGather.Value)
 / (Sum(Fields!OffWorkTimeValueGather.Value) + Sum(Fields!OnWorkTimeValueGather.Value)), "0.00%"))</Label>
                        <Visible>true</Visible>
                      </ChartDataLabel>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Shape</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
              </ChartSeriesCollection>
            </ChartData>
            <ChartAreas>
              <ChartArea Name="Default">
                <ChartCategoryAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartCategoryAxes>
                <ChartValueAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartValueAxes>
                <ChartThreeDProperties>
                  <Enabled>true</Enabled>
                </ChartThreeDProperties>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                </Style>
              </ChartArea>
            </ChartAreas>
            <ChartLegends>
              <ChartLegend Name="Default">
                <Hidden>true</Hidden>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartLegendTitle>
                  <Caption />
                  <Style>
                    <FontSize>8pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </ChartLegendTitle>
                <HeaderSeparatorColor>Black</HeaderSeparatorColor>
                <ColumnSeparatorColor>Black</ColumnSeparatorColor>
              </ChartLegend>
            </ChartLegends>
            <ChartTitles>
              <ChartTitle Name="Default">
                <Caption>=Parameters!機櫃.Value+"班次用電量對比"</Caption>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontWeight>Bold</FontWeight>
                  <TextAlign>General</TextAlign>
                  <VerticalAlign>Top</VerticalAlign>
                </Style>
              </ChartTitle>
            </ChartTitles>
            <Palette>BrightPastel</Palette>
            <ChartBorderSkin>
              <Style>
                <BackgroundColor>Gray</BackgroundColor>
                <BackgroundGradientType>None</BackgroundGradientType>
                <Color>White</Color>
              </Style>
            </ChartBorderSkin>
            <ChartNoDataMessage Name="NoDataMessage">
              <Caption>沒有可用資料</Caption>
              <Style>
                <BackgroundGradientType>None</BackgroundGradientType>
                <TextAlign>General</TextAlign>
                <VerticalAlign>Top</VerticalAlign>
              </Style>
            </ChartNoDataMessage>
            <DataSetName>上下班電能匯總</DataSetName>
            <Top>234.20749mm</Top>
            <Left>1.473mm</Left>
            <Height>80.42708mm</Height>
            <Width>107.04634mm</Width>
            <ZIndex>6</ZIndex>
            <Visibility>
              <Hidden>=IIf(Parameters!機櫃.Value &lt;&gt; "ALL", False, True)</Hidden>
            </Visibility>
            <Style>
              <Border>
                <Color>LightGrey</Color>
                <Style>Solid</Style>
              </Border>
              <BackgroundColor>White</BackgroundColor>
              <BackgroundGradientType>None</BackgroundGradientType>
            </Style>
          </Chart>
          <Chart Name="Chart9">
            <ChartCategoryHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Group Name="Chart9_CategoryGroup">
                    <GroupExpressions>
                      <GroupExpression>=Fields!ID_Date.Value</GroupExpression>
                    </GroupExpressions>
                  </Group>
                  <SortExpressions>
                    <SortExpression>
                      <Value>=Fields!ID_Date.Value</Value>
                    </SortExpression>
                  </SortExpressions>
                  <Label>=Fields!ID_Date.Value</Label>
                </ChartMember>
              </ChartMembers>
            </ChartCategoryHierarchy>
            <ChartSeriesHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Label>Off Work Time Value</Label>
                </ChartMember>
                <ChartMember>
                  <Label>Off Work Time Value</Label>
                </ChartMember>
                <ChartMember>
                  <Label>On Work Time Value</Label>
                </ChartMember>
              </ChartMembers>
            </ChartSeriesHierarchy>
            <ChartData>
              <ChartSeriesCollection>
                <ChartSeries Name="下班總電能">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=Sum(Fields!OffWorkTimeValue.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style>
                          <Format>f2</Format>
                        </Style>
                        <UseValueAsLabel>true</UseValueAsLabel>
                        <Visible>true</Visible>
                      </ChartDataLabel>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
                <ChartSeries Name="Series">
                  <Hidden>true</Hidden>
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=(Sum(Fields!OnWorkTimeValue.Value) + Sum(Fields!OffWorkTimeValue.Value)) / 2</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style />
                      </ChartDataLabel>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
                <ChartSeries Name="上班總電能">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=Sum(Fields!OnWorkTimeValue.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style>
                          <Format>f2</Format>
                        </Style>
                        <UseValueAsLabel>true</UseValueAsLabel>
                        <Visible>true</Visible>
                      </ChartDataLabel>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
              </ChartSeriesCollection>
              <ChartDerivedSeriesCollection>
                <ChartDerivedSeries>
                  <ChartSeries Name="DerivedSeries1">
                    <Type>Line</Type>
                    <Style>
                      <Border>
                        <Width>2pt</Width>
                      </Border>
                    </Style>
                    <ChartMarker>
                      <Type>Auto</Type>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style>
                        <Format>f2</Format>
                      </Style>
                      <UseValueAsLabel>true</UseValueAsLabel>
                      <Visible>true</Visible>
                    </ChartDataLabel>
                    <ChartEmptyPoints>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <ChartDataLabel>
                        <Style />
                      </ChartDataLabel>
                    </ChartEmptyPoints>
                    <ChartItemInLegend>
                      <LegendText>平均值</LegendText>
                    </ChartItemInLegend>
                    <ChartAreaName>Default</ChartAreaName>
                    <ValueAxisName>Primary</ValueAxisName>
                    <CategoryAxisName>Primary</CategoryAxisName>
                    <ChartSmartLabel>
                      <CalloutLineColor>Black</CalloutLineColor>
                      <MinMovingDistance>0pt</MinMovingDistance>
                    </ChartSmartLabel>
                  </ChartSeries>
                  <SourceChartSeriesName>Series</SourceChartSeriesName>
                  <DerivedSeriesFormula>MovingAverage</DerivedSeriesFormula>
                  <ChartFormulaParameters>
                    <ChartFormulaParameter Name="Period">
                      <Value>1</Value>
                    </ChartFormulaParameter>
                    <ChartFormulaParameter Name="StartFromFirst">
                      <Value>False</Value>
                    </ChartFormulaParameter>
                  </ChartFormulaParameters>
                </ChartDerivedSeries>
              </ChartDerivedSeriesCollection>
            </ChartData>
            <ChartAreas>
              <ChartArea Name="Default">
                <ChartCategoryAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>時間</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <Interval>1</Interval>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <Angle>-30</Angle>
                    <LabelsAutoFitDisabled>true</LabelsAutoFitDisabled>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartCategoryAxes>
                <ChartValueAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>電能/KWh</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartValueAxes>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                </Style>
              </ChartArea>
            </ChartAreas>
            <ChartLegends>
              <ChartLegend Name="Default">
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartLegendTitle>
                  <Caption />
                  <Style>
                    <FontSize>8pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </ChartLegendTitle>
                <HeaderSeparatorColor>Black</HeaderSeparatorColor>
                <ColumnSeparatorColor>Black</ColumnSeparatorColor>
              </ChartLegend>
            </ChartLegends>
            <ChartTitles>
              <ChartTitle Name="Default">
                <Caption>=Parameters!機櫃.Value+"上下班電量走勢"</Caption>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontWeight>Bold</FontWeight>
                  <TextAlign>General</TextAlign>
                  <VerticalAlign>Top</VerticalAlign>
                </Style>
              </ChartTitle>
            </ChartTitles>
            <Palette>BrightPastel</Palette>
            <ChartBorderSkin>
              <Style>
                <BackgroundColor>Gray</BackgroundColor>
                <BackgroundGradientType>None</BackgroundGradientType>
                <Color>White</Color>
              </Style>
            </ChartBorderSkin>
            <ChartNoDataMessage Name="NoDataMessage">
              <Caption>沒有可用資料</Caption>
              <Style>
                <BackgroundGradientType>None</BackgroundGradientType>
                <TextAlign>General</TextAlign>
                <VerticalAlign>Top</VerticalAlign>
              </Style>
            </ChartNoDataMessage>
            <DataSetName>上下班電能詳情</DataSetName>
            <Top>15.60672cm</Top>
            <Left>0.11048cm</Left>
            <Height>15.0107cm</Height>
            <Width>31cm</Width>
            <ZIndex>7</ZIndex>
            <Visibility>
              <Hidden>=IIf(Parameters!機櫃.Value &lt;&gt; "ALL", False, True)</Hidden>
            </Visibility>
            <Style>
              <Border>
                <Color>LightGrey</Color>
                <Style>Solid</Style>
              </Border>
              <BackgroundColor>White</BackgroundColor>
              <BackgroundGradientType>None</BackgroundGradientType>
            </Style>
          </Chart>
          <Chart Name="Chart8">
            <ChartCategoryHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Label />
                </ChartMember>
              </ChartMembers>
            </ChartCategoryHierarchy>
            <ChartSeriesHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Label>On Work Day</Label>
                </ChartMember>
                <ChartMember>
                  <Label>Off Work Day</Label>
                </ChartMember>
              </ChartMembers>
            </ChartSeriesHierarchy>
            <ChartData>
              <ChartSeriesCollection>
                <ChartSeries Name="工作日用電量">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=Sum(Fields!OnWorkDay.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style>
                          <Format>f2</Format>
                        </Style>
                        <Label>=

 "工作日"
+ Constants.vbcrlf
+CStr(Format(Sum(Fields!OnWorkDay.Value) / (Sum(Fields!OffWorkDay.Value) 
+ Sum(Fields!OnWorkDay.Value)), "0.00%"))</Label>
                        <Visible>true</Visible>
                      </ChartDataLabel>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Shape</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
                <ChartSeries Name="非工作日用電量">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=Sum(Fields!OffWorkDay.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style />
                        <Label>=

 "非工作日"
+ Constants.vbcrlf
+CStr(Format(Sum(Fields!OffWorkDay.Value) / (Sum(Fields!OffWorkDay.Value) 
+ Sum(Fields!OnWorkDay.Value)), "0.00%"))</Label>
                        <Visible>true</Visible>
                      </ChartDataLabel>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Shape</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style>
                        <Format>f2</Format>
                      </Style>
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
              </ChartSeriesCollection>
            </ChartData>
            <ChartAreas>
              <ChartArea Name="Default">
                <ChartCategoryAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartCategoryAxes>
                <ChartValueAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartValueAxes>
                <ChartThreeDProperties>
                  <Enabled>true</Enabled>
                </ChartThreeDProperties>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                </Style>
              </ChartArea>
            </ChartAreas>
            <ChartLegends>
              <ChartLegend Name="Default">
                <Hidden>true</Hidden>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartLegendTitle>
                  <Caption />
                  <Style>
                    <FontSize>8pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </ChartLegendTitle>
                <HeaderSeparatorColor>Black</HeaderSeparatorColor>
                <ColumnSeparatorColor>Black</ColumnSeparatorColor>
              </ChartLegend>
            </ChartLegends>
            <ChartTitles>
              <ChartTitle Name="Default">
                <Caption>=Parameters!機櫃.Value+"工作日/非工作日用电量对比"</Caption>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontWeight>Bold</FontWeight>
                  <TextAlign>General</TextAlign>
                  <VerticalAlign>Top</VerticalAlign>
                </Style>
              </ChartTitle>
            </ChartTitles>
            <Palette>BrightPastel</Palette>
            <ChartBorderSkin>
              <Style>
                <BackgroundColor>Gray</BackgroundColor>
                <BackgroundGradientType>None</BackgroundGradientType>
                <Color>White</Color>
              </Style>
            </ChartBorderSkin>
            <ChartNoDataMessage Name="NoDataMessage">
              <Caption>沒有可用資料</Caption>
              <Style>
                <BackgroundGradientType>None</BackgroundGradientType>
                <TextAlign>General</TextAlign>
                <VerticalAlign>Top</VerticalAlign>
              </Style>
            </ChartNoDataMessage>
            <DataSetName>工作日與非工作日表格</DataSetName>
            <Top>23.42075cm</Top>
            <Left>10.85193cm</Left>
            <Height>8.04271cm</Height>
            <Width>11.89208cm</Width>
            <ZIndex>8</ZIndex>
            <Visibility>
              <Hidden>=IIf(Parameters!機櫃.Value &lt;&gt; "ALL",False,True)</Hidden>
            </Visibility>
            <Style>
              <Border>
                <Color>LightGrey</Color>
                <Style>Solid</Style>
              </Border>
              <BackgroundColor>White</BackgroundColor>
              <BackgroundGradientType>None</BackgroundGradientType>
            </Style>
          </Chart>
          <Chart Name="Chart2">
            <ChartCategoryHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Label />
                </ChartMember>
              </ChartMembers>
            </ChartCategoryHierarchy>
            <ChartSeriesHierarchy>
              <ChartMembers>
                <ChartMember>
                  <Label>Off Work Time Value Gather</Label>
                </ChartMember>
                <ChartMember>
                  <Label>On Work Time Value Gather</Label>
                </ChartMember>
              </ChartMembers>
            </ChartSeriesHierarchy>
            <ChartData>
              <ChartSeriesCollection>
                <ChartSeries Name="下班總電能">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=Sum(Fields!OffWorkTimeValueGather.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style>
                          <Format>0.00%</Format>
                        </Style>
                        <Label>=
 "下班總電能"
+ Constants.vbcrlf 
+CStr(Format(Sum(Fields!OffWorkTimeValueGather.Value)/
(Fields!DayCount.Value*14.5)
/(Sum(Fields!OnWorkTimeValueGather.Value)/
(Fields!DayCount.Value*9.5) + Sum(Fields!OffWorkTimeValueGather.Value)/
(Fields!DayCount.Value*14.5)), "0.00%"))</Label>
                        <Visible>true</Visible>
                      </ChartDataLabel>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Shape</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ChartItemInLegend>
                    <Hidden>true</Hidden>
                  </ChartItemInLegend>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
                <ChartSeries Name="上班總電能">
                  <ChartDataPoints>
                    <ChartDataPoint>
                      <ChartDataPointValues>
                        <Y>=Sum(Fields!OnWorkTimeValueGather.Value)</Y>
                      </ChartDataPointValues>
                      <ChartDataLabel>
                        <Style>
                          <Format>0.00%</Format>
                        </Style>
                        <Label>=
 "上班總電能"
+ Constants.vbcrlf 
+CStr(Format(Sum(Fields!OnWorkTimeValueGather.Value)/
(Fields!DayCount.Value*9.5)
/(Sum(Fields!OnWorkTimeValueGather.Value)/
(Fields!DayCount.Value*9.5) + Sum(Fields!OffWorkTimeValueGather.Value)/
(Fields!DayCount.Value*14.5)), "0.00%"))</Label>
                        <Visible>true</Visible>
                      </ChartDataLabel>
                      <Style />
                      <ChartMarker>
                        <Style />
                      </ChartMarker>
                      <DataElementOutput>Output</DataElementOutput>
                    </ChartDataPoint>
                  </ChartDataPoints>
                  <Type>Shape</Type>
                  <Style />
                  <ChartEmptyPoints>
                    <Style />
                    <ChartMarker>
                      <Style />
                    </ChartMarker>
                    <ChartDataLabel>
                      <Style />
                    </ChartDataLabel>
                  </ChartEmptyPoints>
                  <ValueAxisName>Primary</ValueAxisName>
                  <CategoryAxisName>Primary</CategoryAxisName>
                  <ChartSmartLabel>
                    <CalloutLineColor>Black</CalloutLineColor>
                    <MinMovingDistance>0pt</MinMovingDistance>
                  </ChartSmartLabel>
                </ChartSeries>
              </ChartSeriesCollection>
            </ChartData>
            <ChartAreas>
              <ChartArea Name="Default">
                <ChartCategoryAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Enabled>False</Enabled>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartCategoryAxes>
                <ChartValueAxes>
                  <ChartAxis Name="Primary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                  <ChartAxis Name="Secondary">
                    <Style>
                      <FontSize>8pt</FontSize>
                    </Style>
                    <ChartAxisTitle>
                      <Caption>軸標題</Caption>
                      <Style>
                        <FontSize>8pt</FontSize>
                      </Style>
                    </ChartAxisTitle>
                    <ChartMajorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                        </Border>
                      </Style>
                    </ChartMajorGridLines>
                    <ChartMinorGridLines>
                      <Style>
                        <Border>
                          <Color>Gainsboro</Color>
                          <Style>Dotted</Style>
                        </Border>
                      </Style>
                    </ChartMinorGridLines>
                    <ChartMinorTickMarks>
                      <Length>0.5</Length>
                    </ChartMinorTickMarks>
                    <CrossAt>NaN</CrossAt>
                    <Location>Opposite</Location>
                    <Minimum>NaN</Minimum>
                    <Maximum>NaN</Maximum>
                    <ChartAxisScaleBreak>
                      <Style />
                    </ChartAxisScaleBreak>
                  </ChartAxis>
                </ChartValueAxes>
                <ChartThreeDProperties>
                  <Enabled>true</Enabled>
                </ChartThreeDProperties>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                </Style>
              </ChartArea>
            </ChartAreas>
            <ChartLegends>
              <ChartLegend Name="Default">
                <Hidden>true</Hidden>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontSize>8pt</FontSize>
                </Style>
                <ChartLegendTitle>
                  <Caption />
                  <Style>
                    <FontSize>8pt</FontSize>
                    <FontWeight>Bold</FontWeight>
                    <TextAlign>Center</TextAlign>
                  </Style>
                </ChartLegendTitle>
                <HeaderSeparatorColor>Black</HeaderSeparatorColor>
                <ColumnSeparatorColor>Black</ColumnSeparatorColor>
              </ChartLegend>
            </ChartLegends>
            <ChartTitles>
              <ChartTitle Name="Default">
                <Caption>班次用電量對比</Caption>
                <Style>
                  <BackgroundGradientType>None</BackgroundGradientType>
                  <FontWeight>Bold</FontWeight>
                  <TextAlign>General</TextAlign>
                  <VerticalAlign>Top</VerticalAlign>
                </Style>
              </ChartTitle>
            </ChartTitles>
            <Palette>BrightPastel</Palette>
            <ChartBorderSkin>
              <Style>
                <BackgroundColor>Gray</BackgroundColor>
                <BackgroundGradientType>None</BackgroundGradientType>
                <Color>White</Color>
              </Style>
            </ChartBorderSkin>
            <ChartNoDataMessage Name="NoDataMessage">
              <Caption>沒有可用資料</Caption>
              <Style>
                <BackgroundGradientType>None</BackgroundGradientType>
                <TextAlign>General</TextAlign>
                <VerticalAlign>Top</VerticalAlign>
              </Style>
            </ChartNoDataMessage>
            <DataSetName>上下班電能匯總</DataSetName>
            <Top>140.02476mm</Top>
            <Left>1.10475mm</Left>
            <Height>80.42708mm</Height>
            <Width>107.04634mm</Width>
            <ZIndex>9</ZIndex>
            <Visibility>
              <Hidden>=IIf(Parameters!機櫃.Value &lt;&gt; "ALL",True,False)</Hidden>
            </Visibility>
            <Style>
              <Border>
                <Color>LightGrey</Color>
                <Style>Solid</Style>
              </Border>
              <BackgroundColor>White</BackgroundColor>
              <BackgroundGradientType>None</BackgroundGradientType>
            </Style>
          </Chart>
          <Textbox Name="Textbox28">
            <CanGrow>true</CanGrow>
            <KeepTogether>true</KeepTogether>
            <Paragraphs>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>說明: 上班時間為：08:00-17:30；其餘時間為下班時間</Value>
                    <Style>
                      <FontStyle>Normal</FontStyle>
                      <FontFamily>微軟正黑體</FontFamily>
                      <FontSize>12pt</FontSize>
                      <FontWeight>Bold</FontWeight>
                      <TextDecoration>None</TextDecoration>
                      <Color>Red</Color>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
              <Paragraph>
                <TextRuns>
                  <TextRun>
                    <Value>        工作日為：星期一至星期五；非工作日為：星期六至星期日</Value>
                    <Style>
                      <FontStyle>Normal</FontStyle>
                      <FontFamily>微軟正黑體</FontFamily>
                      <FontSize>12pt</FontSize>
                      <FontWeight>Bold</FontWeight>
                      <TextDecoration>None</TextDecoration>
                      <Color>Red</Color>
                    </Style>
                  </TextRun>
                </TextRuns>
                <Style />
              </Paragraph>
            </Paragraphs>
            <rd:DefaultName>Textbox28</rd:DefaultName>
            <Top>12.5729in</Top>
            <Left>0.05799in</Left>
            <Height>0.25in</Height>
            <Width>9.38542in</Width>
            <ZIndex>10</ZIndex>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
              <PaddingLeft>2pt</PaddingLeft>
              <PaddingRight>2pt</PaddingRight>
              <PaddingTop>2pt</PaddingTop>
              <PaddingBottom>2pt</PaddingBottom>
            </Style>
          </Textbox>
        </ReportItems>
        <Height>401.5794mm</Height>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Body>
      <Width>311.1048mm</Width>
      <Page>
        <PageFooter>
          <Height>12.75292mm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="ExecutionTime">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Globals!ExecutionTime</Value>
                      <Style />
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <rd:DefaultName>ExecutionTime</rd:DefaultName>
              <Top>0mm</Top>
              <Left>1.10475mm</Left>
              <Height>6.35mm</Height>
              <Width>50.8mm</Width>
              <Style>
                <Border>
                  <Style>None</Style>
                </Border>
                <PaddingLeft>2pt</PaddingLeft>
                <PaddingRight>2pt</PaddingRight>
                <PaddingTop>2pt</PaddingTop>
                <PaddingBottom>2pt</PaddingBottom>
              </Style>
            </Textbox>
          </ReportItems>
          <Style>
            <Border>
              <Style>None</Style>
            </Border>
          </Style>
        </PageFooter>
        <PageHeight>20in</PageHeight>
        <PageWidth>20in</PageWidth>
        <LeftMargin>0.7874in</LeftMargin>
        <RightMargin>0.7874in</RightMargin>
        <TopMargin>0.7874in</TopMargin>
        <BottomMargin>0.7874in</BottomMargin>
        <ColumnSpacing>0.13cm</ColumnSpacing>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="廠區">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>龍華</Value>
        </Values>
      </DefaultValue>
      <Prompt>廠區</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>工廠下拉</DataSetName>
          <ValueField>Plant</ValueField>
          <LabelField>Plant</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="樓棟">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>C8棟1樓</Value>
        </Values>
      </DefaultValue>
      <Prompt>樓棟</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>樓棟</DataSetName>
          <ValueField>Building</ValueField>
          <LabelField>Building</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="機房">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>A</Value>
        </Values>
      </DefaultValue>
      <Prompt>機房</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>機房</DataSetName>
          <ValueField>ComputerRoom</ValueField>
          <LabelField>ComputerRoom</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="月份">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>預設值</DataSetName>
          <ValueField>月份預設</ValueField>
        </DataSetReference>
      </DefaultValue>
      <AllowBlank>true</AllowBlank>
      <Prompt>月份</Prompt>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>1</Value>
            <Label>1</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>2</Value>
            <Label>2</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>3</Value>
            <Label>3</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>4</Value>
            <Label>4</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>5</Value>
            <Label>5</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>6</Value>
            <Label>6</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>7</Value>
            <Label>7</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>8</Value>
            <Label>8</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>9</Value>
            <Label>9</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>10</Value>
            <Label>10</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>11</Value>
            <Label>11</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>12</Value>
            <Label>12</Label>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="機櫃">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>機櫃下拉</DataSetName>
          <ValueField>機櫃名稱</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>機櫃</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>機櫃下拉</DataSetName>
          <ValueField>機櫃名稱</ValueField>
          <LabelField>機櫃名稱</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="年份">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>=Year(Globals!ExecutionTime)</Value>
        </Values>
      </DefaultValue>
      <Prompt>年份</Prompt>
    </ReportParameter>
  </ReportParameters>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportServerUrl>http://10.62.197.16/ReportServer</rd:ReportServerUrl>
  <rd:ReportID>f641c6b1-9f7c-44c6-aa85-4c2dba3cedb8</rd:ReportID>
</Report>